<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>grib2.grib2</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th bgcolor="#70b0f0" class="navbar-select"
          >&nbsp;&nbsp;&nbsp;Home&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;grib2 ::
        Module&nbsp;grib2
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="grib2.grib2-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="grib2.grib2-module.html">Module grib2.grib2</a></h1>
<pre class="py-src">
<span class="py-lineno">   1</span>  <span class="py-line"><span id="link-0" class="py-name"><a title="grib2.grib2.__version__" class="py-name" href="#" onclick="doclink('link-0', '__version__', 'Variable grib2.grib2.__version__=grib2.grib2-module.html#__version__'); return false;">__version__</a></span></span> <span class="py-op">=</span> <span class="py-docstring">'20070515'</span> </span>
<span class="py-lineno">   2</span>  <span class="py-line"><span id="link-1" class="py-name"><a title="grib2.grib2.__doc__" class="py-name" href="#" onclick="doclink('link-1', '__doc__', 'Variable grib2.grib2.__doc__=grib2.grib2-module.html#__doc__'); return false;">__doc__</a></span></span><span class="py-op">=</span><span class="py-string">"""</span> </span>
<span class="py-lineno">   3</span>  <span class="py-line"><span class="py-string">Introduction</span> </span>
<span class="py-lineno">   4</span>  <span class="py-line"><span class="py-string">============</span> </span>
<span class="py-lineno">   5</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">   6</span>  <span class="py-line"><span class="py-string">Python module for reading and writing GRIB edition 2 (GRIB2) files</span> </span>
<span class="py-lineno">   7</span>  <span class="py-line"><span class="py-string">(U{download&lt;http://code.google.com/p/pygrib2/downloads/list&gt;}). </span> </span>
<span class="py-lineno">   8</span>  <span class="py-line"><span class="py-string">GRIB2 is the second version of the World Meterological Organization</span> </span>
<span class="py-lineno">   9</span>  <span class="py-line"><span class="py-string">(WMO) standard for distributing gridded data. The standard is</span> </span>
<span class="py-lineno">  10</span>  <span class="py-line"><span class="py-string">outlined in U{FM92 GRIB Edition 2, Code Form and Tables</span> </span>
<span class="py-lineno">  11</span>  <span class="py-line"><span class="py-string">&lt;http://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc.shtml&gt;}. The module</span> </span>
<span class="py-lineno">  12</span>  <span class="py-line"><span class="py-string">includes a programmer interface for reading/writing GRIB2 grids as well as command</span> </span>
<span class="py-lineno">  13</span>  <span class="py-line"><span class="py-string">line utilities for listing the contents of a grib file and 're-packing' a</span> </span>
<span class="py-lineno">  14</span>  <span class="py-line"><span class="py-string">grib file using a different compression scheme.</span> </span>
<span class="py-lineno">  15</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  16</span>  <span class="py-line"><span class="py-string">Required</span> </span>
<span class="py-lineno">  17</span>  <span class="py-line"><span class="py-string">========</span> </span>
<span class="py-lineno">  18</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  19</span>  <span class="py-line"><span class="py-string">- U{Python&lt;http://python.org&gt;} 2.3 or higher.  </span> </span>
<span class="py-lineno">  20</span>  <span class="py-line"><span class="py-string">- U{numpy&lt;http://sourceforge.net/project/showfiles.php?group_id=1369&gt;}</span> </span>
<span class="py-lineno">  21</span>  <span class="py-line"><span class="py-string">  N-dimensional array object for python.</span> </span>
<span class="py-lineno">  22</span>  <span class="py-line"><span class="py-string">- U{pyproj&lt;http://code.google.com/p/pyproj/&gt;} Python interface to </span> </span>
<span class="py-lineno">  23</span>  <span class="py-line"><span class="py-string">  U{PROJ.4&lt;http://proj.maptools.org&gt;} library for cartographic transformations.</span> </span>
<span class="py-lineno">  24</span>  <span class="py-line"><span class="py-string">  U{PROJ.4&lt;http://proj.maptools.org&gt;} library must be installed first.</span> </span>
<span class="py-lineno">  25</span>  <span class="py-line"><span class="py-string">- U{Jasper&lt;http://www.ece.uvic.ca/~mdadams/jasper&gt;} library. This library</span> </span>
<span class="py-lineno">  26</span>  <span class="py-line"><span class="py-string">  is a C implementation of the JPEG-2000 Part-1 standard (ISO/IEC 15444-1).</span> </span>
<span class="py-lineno">  27</span>  <span class="py-line"><span class="py-string">- U{PNG&lt;http://www.libpng.org/pub/png/libpng.html&gt;} library. This library</span> </span>
<span class="py-lineno">  28</span>  <span class="py-line"><span class="py-string">  is a C implementation of the Portable Network Graphics</span> </span>
<span class="py-lineno">  29</span>  <span class="py-line"><span class="py-string">  (PNG) image compression format. It's probably already on your system.</span> </span>
<span class="py-lineno">  30</span>  <span class="py-line"><span class="py-string">- U{zlib&lt;http://www.gzip.org/zlib/&gt;} compression library.</span> </span>
<span class="py-lineno">  31</span>  <span class="py-line"><span class="py-string">  It's almost certainly already on your system.</span> </span>
<span class="py-lineno">  32</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  33</span>  <span class="py-line"><span class="py-string">Installation</span> </span>
<span class="py-lineno">  34</span>  <span class="py-line"><span class="py-string">============</span> </span>
<span class="py-lineno">  35</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  36</span>  <span class="py-line"><span class="py-string"> - set the environment variables C{$JASPER_DIR}, C{$PNG_DIR} and </span> </span>
<span class="py-lineno">  37</span>  <span class="py-line"><span class="py-string"> C{$ZLIB_DIR} so that the include files and libraries for jasper,</span> </span>
<span class="py-lineno">  38</span>  <span class="py-line"><span class="py-string"> png and zlib will be found.  For example, the include files for </span> </span>
<span class="py-lineno">  39</span>  <span class="py-line"><span class="py-string"> jasper should be found in C{$JASPER_DIR/include}, and the jasper</span> </span>
<span class="py-lineno">  40</span>  <span class="py-line"><span class="py-string"> library should be found in C{$JASPER_DIR/lib}.</span> </span>
<span class="py-lineno">  41</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  42</span>  <span class="py-line"><span class="py-string"> - Run 'python setup.py install', as root if necessary.</span> </span>
<span class="py-lineno">  43</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  44</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  45</span>  <span class="py-line"><span class="py-string">Example usage</span> </span>
<span class="py-lineno">  46</span>  <span class="py-line"><span class="py-string">=============</span> </span>
<span class="py-lineno">  47</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  48</span>  <span class="py-line"><span class="py-string"> - from the python interpreter prompt, import the package::</span> </span>
<span class="py-lineno">  49</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; from grib2 import Grib2Decode, dump</span> </span>
<span class="py-lineno">  50</span>  <span class="py-line"><span class="py-string"> - open a GRIB2 file, create a list of Grib2Message instances::</span> </span>
<span class="py-lineno">  51</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; grbs = Grib2Decode('sampledata/gfs.grb')  </span> </span>
<span class="py-lineno">  52</span>  <span class="py-line"><span class="py-string"> - print an inventory of the file::</span> </span>
<span class="py-lineno">  53</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; for grb in grbs:</span> </span>
<span class="py-lineno">  54</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt;     print grb </span> </span>
<span class="py-lineno">  55</span>  <span class="py-line"><span class="py-string">    1:Geopotential height [gpm]:100000 Pa (Isobaric surface):72 Hour Forecast initialized 2004120912:Latitude/longitude:Unperturbed high-resolution control forecast member 0 of 10</span> </span>
<span class="py-lineno">  56</span>  <span class="py-line"><span class="py-string">    2:Geopotential height [gpm]:97500 Pa (Isobaric surface):72 Hour Forecast initialized 2004120912:Latitude/longitude:Unperturbed high-resolution control forecast member 0 of 10</span> </span>
<span class="py-lineno">  57</span>  <span class="py-line"><span class="py-string">    3:Geopotential height [gpm]:95000 Pa (Isobaric surface):72 Hour Forecast initialized 2004120912:Latitude/longitude:Unperturbed high-resolution control forecast member 0 of 10</span> </span>
<span class="py-lineno">  58</span>  <span class="py-line"><span class="py-string">  </span> </span>
<span class="py-lineno">  59</span>  <span class="py-line"><span class="py-string">       .....</span> </span>
<span class="py-lineno">  60</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  61</span>  <span class="py-line"><span class="py-string"> - find the first grib message containing 500 hPa geopotential height:: </span> </span>
<span class="py-lineno">  62</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; z500 = [g for g in grbs if g.parameter=='Geopotential height' and g.vertical_level=='50000 Pa' and g.vertical_level_descriptor=='Isobaric surface'][0]</span> </span>
<span class="py-lineno">  63</span>  <span class="py-line"><span class="py-string"> - extract the 500 hPa height data::</span> </span>
<span class="py-lineno">  64</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; z500data = z500.data()</span> </span>
<span class="py-lineno">  65</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; print z500.shape, z500data.min(), z500data.max()</span> </span>
<span class="py-lineno">  66</span>  <span class="py-line"><span class="py-string">    (73, 144) 4834.89990234 5931.20019531</span> </span>
<span class="py-lineno">  67</span>  <span class="py-line"><span class="py-string"> - get the latitudes and longitudes of the grid::</span> </span>
<span class="py-lineno">  68</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; lats, lons = z500.grid()</span> </span>
<span class="py-lineno">  69</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; print lats.shape, lats.min(), lats.max(), lons.shape, lons.min(), lons.max()</span> </span>
<span class="py-lineno">  70</span>  <span class="py-line"><span class="py-string">    (73, 144) -90.0 90.0 (73, 144) 0.0 357.5</span> </span>
<span class="py-lineno">  71</span>  <span class="py-line"><span class="py-string"> - dump just this grib message to another file::</span> </span>
<span class="py-lineno">  72</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; dump('gfs_z500.grb',[z500])</span> </span>
<span class="py-lineno">  73</span>  <span class="py-line"><span class="py-string"> - read that file back in and verify it's contents::</span> </span>
<span class="py-lineno">  74</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; grbs = Grib2Decode('gfs_z500.grb')</span> </span>
<span class="py-lineno">  75</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt; for g in grbs:</span> </span>
<span class="py-lineno">  76</span>  <span class="py-line"><span class="py-string">    &gt;&gt;&gt;    print g</span> </span>
<span class="py-lineno">  77</span>  <span class="py-line"><span class="py-string">    1:Geopotential height [gpm]:50000 Pa (Isobaric surface):72 Hour Forecast initialized 2004120912:Latitude/longitude:Unperturbed high-resolution control forecast member 0 of 10</span> </span>
<span class="py-lineno">  78</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  79</span>  <span class="py-line"><span class="py-string">Documentation</span> </span>
<span class="py-lineno">  80</span>  <span class="py-line"><span class="py-string">=============</span> </span>
<span class="py-lineno">  81</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  82</span>  <span class="py-line"><span class="py-string"> - see below for python API documentation (L{Grib2Decode}, L{Grib2Encode},</span> </span>
<span class="py-lineno">  83</span>  <span class="py-line"><span class="py-string">   L{Grib2Message}, L{dump}).</span> </span>
<span class="py-lineno">  84</span>  <span class="py-line"><span class="py-string">  </span> </span>
<span class="py-lineno">  85</span>  <span class="py-line"><span class="py-string">Links</span> </span>
<span class="py-lineno">  86</span>  <span class="py-line"><span class="py-string">=====</span> </span>
<span class="py-lineno">  87</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  88</span>  <span class="py-line"><span class="py-string"> - U{wgrib2&lt;http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/&gt;}</span> </span>
<span class="py-lineno">  89</span>  <span class="py-line"><span class="py-string"> - U{NCEP GRIB2 C and FORTRAN libraries</span> </span>
<span class="py-lineno">  90</span>  <span class="py-line"><span class="py-string">   &lt;http://www.nco.ncep.noaa.gov/pmb/codes/GRIB2/&gt;}. This package uses</span> </span>
<span class="py-lineno">  91</span>  <span class="py-line"><span class="py-string">   C routines from g2clib.  </span> </span>
<span class="py-lineno">  92</span>  <span class="py-line"><span class="py-string"> - U{ECMWF gribAPI&lt;http://www.ecmwf.int/products/data/software/grib2.html&gt;}</span> </span>
<span class="py-lineno">  93</span>  <span class="py-line"><span class="py-string"> - U{MDL GRIB2 Decoder&lt;http://weather.gov/mdl/iwt/grib2/decoder.htm&gt;}</span> </span>
<span class="py-lineno">  94</span>  <span class="py-line"><span class="py-string"> - U{Pyrex&lt;http://nz.cosc.canterbury.ac.nz/~greg/python/Pyrex/&gt;}</span> </span>
<span class="py-lineno">  95</span>  <span class="py-line"><span class="py-string"> (used to create python interface to g2clib and proj4).</span> </span>
<span class="py-lineno">  96</span>  <span class="py-line"><span class="py-string"> - U{proj.4&lt;http://proj.maptools.org&gt;} (used to perform cartographic</span> </span>
<span class="py-lineno">  97</span>  <span class="py-line"><span class="py-string"> transformations).</span> </span>
<span class="py-lineno">  98</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno">  99</span>  <span class="py-line"><span class="py-string">Changelog</span> </span>
<span class="py-lineno"> 100</span>  <span class="py-line"><span class="py-string">=========</span> </span>
<span class="py-lineno"> 101</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 102</span>  <span class="py-line"><span class="py-string"> - B{20041213}: initial release. Fully supports lat/lon, gaussian, lambert</span> </span>
<span class="py-lineno"> 103</span>  <span class="py-line"><span class="py-string">   conformal, polar stereographic and mercator grids.  Includes all</span> </span>
<span class="py-lineno"> 104</span>  <span class="py-line"><span class="py-string">   product (section 4) tables included in the 20031105 version of the WMO</span> </span>
<span class="py-lineno"> 105</span>  <span class="py-line"><span class="py-string">   GRIB2 U{document&lt;http://www.wmo.ch/web/www/DPS/grib-2.html&gt;}. Works with</span> </span>
<span class="py-lineno"> 106</span>  <span class="py-line"><span class="py-string">   every GRIB2 file I could find - if you find one it has trouble with please</span> </span>
<span class="py-lineno"> 107</span>  <span class="py-line"><span class="py-string">   let me know.</span> </span>
<span class="py-lineno"> 108</span>  <span class="py-line"><span class="py-string"> - B{20041215}: Fixed to handle files with 'communications headers' at</span> </span>
<span class="py-lineno"> 109</span>  <span class="py-line"><span class="py-string">   beginning of GRIB message.</span> </span>
<span class="py-lineno"> 110</span>  <span class="py-line"><span class="py-string"> - B{20041217}: Added C{matchrecs} class method to find GRIB records with</span> </span>
<span class="py-lineno"> 111</span>  <span class="py-line"><span class="py-string">   matching gdtnum, pdtnum, idsect, gdtmpl or pdtmpl values. Added example</span> </span>
<span class="py-lineno"> 112</span>  <span class="py-line"><span class="py-string">   that reads an ETA grid and plots it with U{Matplotlib&lt;http://matplotlib.sf.net/&gt;}.</span> </span>
<span class="py-lineno"> 113</span>  <span class="py-line"><span class="py-string"> - B{20050118}: Updated C code to g2clib-1.0.2 (from 1.0.1).</span> </span>
<span class="py-lineno"> 114</span>  <span class="py-line"><span class="py-string"> - B{20050316}: added a new class (L{Grib2Encode}) for encoding GRIB2 messages.</span> </span>
<span class="py-lineno"> 115</span>  <span class="py-line"><span class="py-string">   Renamed Grib2 class L{Grib2Decode}. Additional options for rdgrib utility.</span> </span>
<span class="py-lineno"> 116</span>  <span class="py-line"><span class="py-string"> - B{20050322}: bugfixes for L{Grib2Encode}.</span> </span>
<span class="py-lineno"> 117</span>  <span class="py-line"><span class="py-string">   Added test script (test3.py) that exercises both Grib2Decode and Grib2Encode.</span> </span>
<span class="py-lineno"> 118</span>  <span class="py-line"><span class="py-string"> - B{20050716}: Added some support for irregular grids (such as </span> </span>
<span class="py-lineno"> 119</span>  <span class="py-line"><span class="py-string">   ECMWF reduced gaussian grids). JPEG2000 and PNG support is now optional.</span> </span>
<span class="py-lineno"> 120</span>  <span class="py-line"><span class="py-string"> - B{20050829}: getfld and getflds L{Grib2Decode} methods can</span> </span>
<span class="py-lineno"> 121</span>  <span class="py-line"><span class="py-string">   now return masked arrays when there is a bitmap.</span> </span>
<span class="py-lineno"> 122</span>  <span class="py-line"><span class="py-string"> - B{20050830}: Now displays more ensemble info in inventory.</span> </span>
<span class="py-lineno"> 123</span>  <span class="py-line"><span class="py-string"> - B{20051121}: Now uses Numeric by default (no longer requires</span> </span>
<span class="py-lineno"> 124</span>  <span class="py-line"><span class="py-string">   numarray).  Can easily be modified to use nummarray or Numeric by</span> </span>
<span class="py-lineno"> 125</span>  <span class="py-line"><span class="py-string">   modifying the imports in 3 files (grib2.py, proj.py and gaussian.py).</span> </span>
<span class="py-lineno"> 126</span>  <span class="py-line"><span class="py-string">   A new utility, gribrepack, is included for repacking a grib2 file</span> </span>
<span class="py-lineno"> 127</span>  <span class="py-line"><span class="py-string">   with a different compression scheme.</span> </span>
<span class="py-lineno"> 128</span>  <span class="py-line"><span class="py-string"> - B{20051125}: Updated grib2 tables to version 3 (released</span> </span>
<span class="py-lineno"> 129</span>  <span class="py-line"><span class="py-string">   by WMO on Nov 2, 2005).</span> </span>
<span class="py-lineno"> 130</span>  <span class="py-line"><span class="py-string"> - B{20060117}: Now uses numpy by default (instead of Numeric).</span> </span>
<span class="py-lineno"> 131</span>  <span class="py-line"><span class="py-string">   Python 2.5 compatibility fixes.</span> </span>
<span class="py-lineno"> 132</span>  <span class="py-line"><span class="py-string"> - B{20070130}: Fixes some bugs found by Rob Cermak.  Now</span> </span>
<span class="py-lineno"> 133</span>  <span class="py-line"><span class="py-string">   requires pyproj be installed first (which in turn requires</span> </span>
<span class="py-lineno"> 134</span>  <span class="py-line"><span class="py-string">   that you have the PROJ.4 C-library installed). Updated to g2clib 1.0.4.</span> </span>
<span class="py-lineno"> 135</span>  <span class="py-line"><span class="py-string"> - B{20070428}: Fixed memory leaks with a patch provided</span> </span>
<span class="py-lineno"> 136</span>  <span class="py-line"><span class="py-string">   by Thomas Natschlager.</span> </span>
<span class="py-lineno"> 137</span>  <span class="py-line"><span class="py-string"> - B{20070501}: Included new parameters approved by WMO</span> </span>
<span class="py-lineno"> 138</span>  <span class="py-line"><span class="py-string">   for operational implementation in November, 2007.</span> </span>
<span class="py-lineno"> 139</span>  <span class="py-line"><span class="py-string">   These new parameters are used in the U{TIGGE</span> </span>
<span class="py-lineno"> 140</span>  <span class="py-line"><span class="py-string">   &lt;http://tigge.ecmwf.int/tigge/d/tigge/&gt;} grib2 files, so now all TIGGE</span> </span>
<span class="py-lineno"> 141</span>  <span class="py-line"><span class="py-string">   files should be interpreted correctly. 'Reduced' global gaussian grids</span> </span>
<span class="py-lineno"> 142</span>  <span class="py-line"><span class="py-string">   (from ECMWF) are now expanded to full global gaussian grids automatically</span> </span>
<span class="py-lineno"> 143</span>  <span class="py-line"><span class="py-string">   using linear interpolation.</span> </span>
<span class="py-lineno"> 144</span>  <span class="py-line"><span class="py-string"> - B{20070503}: Now partially supports grid definition template 90 (space-view</span> </span>
<span class="py-lineno"> 145</span>  <span class="py-line"><span class="py-string">   satellite projection). Can't yet handle case when sub-satellite point is off the</span> </span>
<span class="py-lineno"> 146</span>  <span class="py-line"><span class="py-string">   equator and earth is specified as an oblate spheroid. Does work with EUMETSAT</span> </span>
<span class="py-lineno"> 147</span>  <span class="py-line"><span class="py-string">   grib2 files.  Bug fix for Oblate Spheroid earth shape (major and minor</span> </span>
<span class="py-lineno"> 148</span>  <span class="py-line"><span class="py-string">   radii are actually in km, not m).</span> </span>
<span class="py-lineno"> 149</span>  <span class="py-line"><span class="py-string"> - B{%(__version__)s}: Totally revamped API for reading.  Now hosted on google code.</span> </span>
<span class="py-lineno"> 150</span>  <span class="py-line"><span class="py-string">   Supports Albers equal area, and azimuthal equidistant projections, although</span> </span>
<span class="py-lineno"> 151</span>  <span class="py-line"><span class="py-string">   these are untested since I couldn't find any grib files in the wild that use these.</span> </span>
<span class="py-lineno"> 152</span>  <span class="py-line"><span class="py-string">   Some support for spectral data and rotated lat/lon and gaussian grids.</span> </span>
<span class="py-lineno"> 153</span>  <span class="py-line"><span class="py-string">   If data in grib file is in column-major storage order, an exception is</span> </span>
<span class="py-lineno"> 154</span>  <span class="py-line"><span class="py-string">   raised.  I could make this work, but I don't have a grib file to test</span> </span>
<span class="py-lineno"> 155</span>  <span class="py-line"><span class="py-string">   it on (if you have one, please forward it to me).  Lots of bug fixes.</span> </span>
<span class="py-lineno"> 156</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 157</span>  <span class="py-line"><span class="py-string">@author: Jeffrey Whitaker.</span> </span>
<span class="py-lineno"> 158</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 159</span>  <span class="py-line"><span class="py-string">@contact: U{Jeff Whitaker&lt;mailto:jeffrey.s.whitaker@noaa.gov&gt;}</span> </span>
<span class="py-lineno"> 160</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 161</span>  <span class="py-line"><span class="py-string">@version: %(__version__)s</span> </span>
<span class="py-lineno"> 162</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 163</span>  <span class="py-line"><span class="py-string">@copyright: copyright 2007 by Jeffrey Whitaker.</span> </span>
<span class="py-lineno"> 164</span>  <span class="py-line"><span class="py-string"></span> </span>
<span class="py-lineno"> 165</span>  <span class="py-line"><span class="py-string">@license: Permission to use, copy, modify, and distribute this software and its</span> </span>
<span class="py-lineno"> 166</span>  <span class="py-line"><span class="py-string">documentation for any purpose and without fee is hereby granted,</span> </span>
<span class="py-lineno"> 167</span>  <span class="py-line"><span class="py-string">provided that the above copyright notice appear in all copies and that</span> </span>
<span class="py-lineno"> 168</span>  <span class="py-line"><span class="py-string">both that copyright notice and this permission notice appear in</span> </span>
<span class="py-lineno"> 169</span>  <span class="py-line"><span class="py-string">supporting documentation.</span> </span>
<span class="py-lineno"> 170</span>  <span class="py-line"><span class="py-string">THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,</span> </span>
<span class="py-lineno"> 171</span>  <span class="py-line"><span class="py-string">INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO</span> </span>
<span class="py-lineno"> 172</span>  <span class="py-line"><span class="py-string">EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, INDIRECT OR</span> </span>
<span class="py-lineno"> 173</span>  <span class="py-line"><span class="py-string">CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF</span> </span>
<span class="py-lineno"> 174</span>  <span class="py-line"><span class="py-string">USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR</span> </span>
<span class="py-lineno"> 175</span>  <span class="py-line"><span class="py-string">OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR</span> </span>
<span class="py-lineno"> 176</span>  <span class="py-line"><span class="py-string">PERFORMANCE OF THIS SOFTWARE.</span> </span>
<span class="py-lineno"> 177</span>  <span class="py-line"><span class="py-string">"""</span> <span class="py-op">%</span> <span class="py-name">locals</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 178</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">g2lib</span> </span>
<span class="py-lineno"> 179</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">sxn0</span><span class="py-op">,</span> <span class="py-name">sxn3</span><span class="py-op">,</span> <span class="py-name">sxn4</span> </span>
<span class="py-lineno"> 180</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">struct</span> </span>
<span class="py-lineno"> 181</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">gaussian</span> </span>
<span class="py-lineno"> 182</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">string</span> </span>
<span class="py-lineno"> 183</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">math</span> </span>
<span class="py-lineno"> 184</span>  <span class="py-line"> </span>
<span class="py-lineno"> 185</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">numpy</span> <span class="py-keyword">as</span> <span class="py-name">N</span> </span>
<span class="py-lineno"> 186</span>  <span class="py-line"><span class="py-keyword">from</span> <span class="py-name">numpy</span> <span class="py-keyword">import</span> <span class="py-name">ma</span> </span>
<span class="py-lineno"> 187</span>  <span class="py-line"><span class="py-keyword">from</span> <span class="py-name">proj</span> <span class="py-keyword">import</span> <span class="py-name">Proj</span> </span>
<span class="py-lineno"> 188</span>  <span class="py-line"><span class="py-keyword">import</span> <span class="py-name">pyproj</span> </span>
<span class="py-lineno"> 189</span>  <span class="py-line"> </span>
<a name="_dec2bin"></a><div id="_dec2bin-def"><span class="py-lineno"> 190</span> <a class="py-toggle" href="#" id="_dec2bin-toggle" onclick="toggle('_dec2bin'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_dec2bin">_dec2bin</a><span class="py-op">(</span><span class="py-param">val</span><span class="py-op">,</span> <span class="py-param">maxbits</span> <span class="py-op">=</span> <span class="py-number">8</span><span class="py-op">)</span><span class="py-op">:</span>  </span>
</div><span class="py-lineno"> 191</span>  <span class="py-line">    <span class="py-docstring">""" </span> </span>
<span class="py-lineno"> 192</span>  <span class="py-line"><span class="py-docstring">    A decimal to binary converter. Returns bits in a list. </span> </span>
<span class="py-lineno"> 193</span>  <span class="py-line"><span class="py-docstring">    """</span>  </span>
<span class="py-lineno"> 194</span>  <span class="py-line">    <span class="py-name">retval</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span>  </span>
<span class="py-lineno"> 195</span>  <span class="py-line">    <span class="py-keyword">for</span> <span class="py-name">i</span> <span class="py-keyword">in</span> <span class="py-name">range</span><span class="py-op">(</span><span class="py-name">maxbits</span> <span class="py-op">-</span> <span class="py-number">1</span><span class="py-op">,</span> <span class="py-op">-</span><span class="py-number">1</span><span class="py-op">,</span> <span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">:</span>  </span>
<span class="py-lineno"> 196</span>  <span class="py-line">        <span class="py-name">bit</span> <span class="py-op">=</span> <span class="py-name">int</span><span class="py-op">(</span><span class="py-name">val</span> <span class="py-op">/</span> <span class="py-op">(</span><span class="py-number">2</span> <span class="py-op">**</span> <span class="py-name">i</span><span class="py-op">)</span><span class="py-op">)</span>  </span>
<span class="py-lineno"> 197</span>  <span class="py-line">        <span class="py-name">val</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-name">val</span> <span class="py-op">%</span> <span class="py-op">(</span><span class="py-number">2</span> <span class="py-op">**</span> <span class="py-name">i</span><span class="py-op">)</span><span class="py-op">)</span>  </span>
<span class="py-lineno"> 198</span>  <span class="py-line">        <span class="py-name">retval</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">bit</span><span class="py-op">)</span>  </span>
<span class="py-lineno"> 199</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">retval</span>  </span>
</div><span class="py-lineno"> 200</span>  <span class="py-line"> </span>
<a name="_putieeeint"></a><div id="_putieeeint-def"><span class="py-lineno"> 201</span> <a class="py-toggle" href="#" id="_putieeeint-toggle" onclick="toggle('_putieeeint'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_putieeeint">_putieeeint</a><span class="py-op">(</span><span class="py-param">r</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_putieeeint-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_putieeeint-expanded"><span class="py-lineno"> 202</span>  <span class="py-line">    <span class="py-docstring">"""convert a float to a IEEE format 32 bit integer"""</span> </span>
<span class="py-lineno"> 203</span>  <span class="py-line">    <span class="py-name">ra</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-op">[</span><span class="py-name">r</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 204</span>  <span class="py-line">    <span class="py-name">ia</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">(</span><span class="py-number">1</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 205</span>  <span class="py-line">    <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">rtoi_ieee</span><span class="py-op">(</span><span class="py-name">ra</span><span class="py-op">,</span><span class="py-name">ia</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 206</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">ia</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
</div><span class="py-lineno"> 207</span>  <span class="py-line"> </span>
<a name="_getieeeint"></a><div id="_getieeeint-def"><span class="py-lineno"> 208</span> <a class="py-toggle" href="#" id="_getieeeint-toggle" onclick="toggle('_getieeeint'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getieeeint">_getieeeint</a><span class="py-op">(</span><span class="py-param">i</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getieeeint-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getieeeint-expanded"><span class="py-lineno"> 209</span>  <span class="py-line">    <span class="py-docstring">"""convert an IEEE format 32 bit integer to a float"""</span> </span>
<span class="py-lineno"> 210</span>  <span class="py-line">    <span class="py-name">ia</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-op">[</span><span class="py-name">i</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 211</span>  <span class="py-line">    <span class="py-name">ra</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">(</span><span class="py-number">1</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 212</span>  <span class="py-line">    <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">itor_ieee</span><span class="py-op">(</span><span class="py-name">ia</span><span class="py-op">,</span><span class="py-name">ra</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 213</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">ra</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
</div><span class="py-lineno"> 214</span>  <span class="py-line"> </span>
<a name="Grib2Message"></a><div id="Grib2Message-def"><span class="py-lineno"> 215</span> <a class="py-toggle" href="#" id="Grib2Message-toggle" onclick="toggle('Grib2Message'); return false;">-</a><span class="py-line"><span class="py-keyword">class</span> <a class="py-def-name" href="grib2.grib2.Grib2Message-class.html">Grib2Message</a><span class="py-op">:</span> </span>
</div><div id="Grib2Message-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="Grib2Message-expanded"><span class="py-lineno"> 216</span>  <span class="py-line">    <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 217</span>  <span class="py-line"><span class="py-docstring"> Class for accessing data in a GRIB Edition 2 message.</span> </span>
<span class="py-lineno"> 218</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 219</span>  <span class="py-line"><span class="py-docstring"> The L{Grib2Decode} function returns a list of these class instances,</span> </span>
<span class="py-lineno"> 220</span>  <span class="py-line"><span class="py-docstring"> one for each grib message in the file.</span> </span>
<span class="py-lineno"> 221</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 222</span>  <span class="py-line"><span class="py-docstring"> When a class instance is created, metadata in the GRIB2 file</span> </span>
<span class="py-lineno"> 223</span>  <span class="py-line"><span class="py-docstring"> is decoded and used to set various instance variables.</span> </span>
<span class="py-lineno"> 224</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno"> 225</span>  <span class="py-line"><span class="py-docstring"> @ivar bitmap_indicator_flag: flag to indicate whether a bit-map is used (0 for yes, 255 for no).</span> </span>
<span class="py-lineno"> 226</span>  <span class="py-line"><span class="py-docstring"> @ivar data_representation_template: data representation template  from section 5.</span> </span>
<span class="py-lineno"> 227</span>  <span class="py-line"><span class="py-docstring"> @ivar data_representation_template_number: data representation template number from section 5.</span> </span>
<span class="py-lineno"> 228</span>  <span class="py-line"><span class="py-docstring"> @ivar discipline: product discipline for grib message.</span> </span>
<span class="py-lineno"> 229</span>  <span class="py-line"><span class="py-docstring"> @ivar discipline_code: product discipline code for grib message.</span> </span>
<span class="py-lineno"> 230</span>  <span class="py-line"><span class="py-docstring"> @ivar earthRmajor: major (equatorial) earth radius.</span> </span>
<span class="py-lineno"> 231</span>  <span class="py-line"><span class="py-docstring"> @ivar earthRminor: minor (polar) earth radius.</span> </span>
<span class="py-lineno"> 232</span>  <span class="py-line"><span class="py-docstring"> @ivar ensemble_info: ensemble member information string.</span> </span>
<span class="py-lineno"> 233</span>  <span class="py-line"><span class="py-docstring"> @ivar forecast_time: string describing forecast time.</span> </span>
<span class="py-lineno"> 234</span>  <span class="py-line"><span class="py-docstring"> @ivar grid_definition_info: grid definition section information from section 3.</span> </span>
<span class="py-lineno"> 235</span>  <span class="py-line"><span class="py-docstring">  See L{Grib2Encode.addgrid} for details.</span> </span>
<span class="py-lineno"> 236</span>  <span class="py-line"><span class="py-docstring"> @ivar grid_definition_template: grid definition template from section 3.</span> </span>
<span class="py-lineno"> 237</span>  <span class="py-line"><span class="py-docstring"> @ivar grid_definition_template_number: grid definition template number from section 3.</span> </span>
<span class="py-lineno"> 238</span>  <span class="py-line"><span class="py-docstring"> @ivar gridlength_in_x_direction: x (or longitudinal) direction grid length.</span> </span>
<span class="py-lineno"> 239</span>  <span class="py-line"><span class="py-docstring"> @ivar gridlength_in_y_direction: y (or latitudinal) direction grid length.</span> </span>
<span class="py-lineno"> 240</span>  <span class="py-line"><span class="py-docstring"> @ivar identification_section: data from identification section (section 1).</span> </span>
<span class="py-lineno"> 241</span>  <span class="py-line"><span class="py-docstring">  See L{Grib2Encode.__init__} for details.</span> </span>
<span class="py-lineno"> 242</span>  <span class="py-line"><span class="py-docstring"> @ivar latitude_first_gridpoint: latitude of first grid point on grid.</span> </span>
<span class="py-lineno"> 243</span>  <span class="py-line"><span class="py-docstring"> @ivar latitude_last_gridpoint: latitude of last grid point on grid.</span> </span>
<span class="py-lineno"> 244</span>  <span class="py-line"><span class="py-docstring"> @ivar longitude_first_gridpoint: longitude of first grid point on grid.</span> </span>
<span class="py-lineno"> 245</span>  <span class="py-line"><span class="py-docstring"> @ivar longitude_last_gridpoint: longitude of last grid point on grid.</span> </span>
<span class="py-lineno"> 246</span>  <span class="py-line"><span class="py-docstring"> @ivar scanmodeflags: scanning mode flags from Table 3.4.</span> </span>
<span class="py-lineno"> 247</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 248</span>  <span class="py-line"><span class="py-docstring">  - bit 1:</span> </span>
<span class="py-lineno"> 249</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 250</span>  <span class="py-line"><span class="py-docstring">    0 - Points in the first row or column scan in the +i (+x) direction</span> </span>
<span class="py-lineno"> 251</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 252</span>  <span class="py-line"><span class="py-docstring">    1 - Points in the first row or column scan in the +i (+x) direction</span> </span>
<span class="py-lineno"> 253</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 254</span>  <span class="py-line"><span class="py-docstring">  - bit 2:</span> </span>
<span class="py-lineno"> 255</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 256</span>  <span class="py-line"><span class="py-docstring">    0 - Points in the first row or column scan in the -j (-y) direction</span> </span>
<span class="py-lineno"> 257</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 258</span>  <span class="py-line"><span class="py-docstring">    1 - Points in the first row or column scan in the +j (+y) direction</span> </span>
<span class="py-lineno"> 259</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 260</span>  <span class="py-line"><span class="py-docstring">  - bit 3:</span> </span>
<span class="py-lineno"> 261</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 262</span>  <span class="py-line"><span class="py-docstring">    0 - Adjacent points in the i (x) direction are consecutive (row-major order).</span> </span>
<span class="py-lineno"> 263</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 264</span>  <span class="py-line"><span class="py-docstring">    1 - Adjacent points in the j (y) direction are consecutive (column-major order).</span> </span>
<span class="py-lineno"> 265</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 266</span>  <span class="py-line"><span class="py-docstring">  - bit 4:</span> </span>
<span class="py-lineno"> 267</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 268</span>  <span class="py-line"><span class="py-docstring">    0 - All rows scan in the same direction</span> </span>
<span class="py-lineno"> 269</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 270</span>  <span class="py-line"><span class="py-docstring">    1 - Adjacent rows scan in the opposite direction</span> </span>
<span class="py-lineno"> 271</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 272</span>  <span class="py-line"><span class="py-docstring"> @ivar number_of_data_points_to_unpack: total number of data points in grib message.</span> </span>
<span class="py-lineno"> 273</span>  <span class="py-line"><span class="py-docstring"> @ivar parameter: string describing the variable in the grib message.</span> </span>
<span class="py-lineno"> 274</span>  <span class="py-line"><span class="py-docstring"> @ivar parameter_category:  string describing the type of variable the grib message.</span> </span>
<span class="py-lineno"> 275</span>  <span class="py-line"><span class="py-docstring"> @ivar parameter_category_code: variable category code.</span> </span>
<span class="py-lineno"> 276</span>  <span class="py-line"><span class="py-docstring"> @ivar parameter_code: variable code.</span> </span>
<span class="py-lineno"> 277</span>  <span class="py-line"><span class="py-docstring"> @ivar parameter_units: units of variable.</span> </span>
<span class="py-lineno"> 278</span>  <span class="py-line"><span class="py-docstring"> @ivar points_in_x_direction: number of points in the x (longitudinal) direction.</span> </span>
<span class="py-lineno"> 279</span>  <span class="py-line"><span class="py-docstring"> @ivar points_in_y_direction: number of points in the y (latitudinal) direction.</span> </span>
<span class="py-lineno"> 280</span>  <span class="py-line"><span class="py-docstring"> @ivar product_definition_template: product definition template nfrom section 4.</span> </span>
<span class="py-lineno"> 281</span>  <span class="py-line"><span class="py-docstring"> @ivar product_definition_template_name: product definition template name.</span> </span>
<span class="py-lineno"> 282</span>  <span class="py-line"><span class="py-docstring"> @ivar product_definition_template_number: product definition template number from section 4.</span> </span>
<span class="py-lineno"> 283</span>  <span class="py-line"><span class="py-docstring"> @ivar shape_of_earth: string describing the shape of the earth (e.g. 'Oblate Spheroid', 'Spheroid').</span> </span>
<span class="py-lineno"> 284</span>  <span class="py-line"><span class="py-docstring"> @ivar type_of_grid: type of grid or map projection (e.g. 'regular lat/lon', 'Lambert Conformal').</span> </span>
<span class="py-lineno"> 285</span>  <span class="py-line"><span class="py-docstring"> @ivar vertical_level: string describing vertical level ('50000 Pa', '10 m', etc).</span> </span>
<span class="py-lineno"> 286</span>  <span class="py-line"><span class="py-docstring"> @ivar vertical_level_descriptor: string describing the type of vertical level </span> </span>
<span class="py-lineno"> 287</span>  <span class="py-line"><span class="py-docstring"> (e.g. 'Isobaric surface').</span> </span>
<span class="py-lineno"> 288</span>  <span class="py-line"><span class="py-docstring"> @ivar spectral_truncation_parameters:  pentagonal truncation parameters that describe the </span> </span>
<span class="py-lineno"> 289</span>  <span class="py-line"><span class="py-docstring"> spherical harmonic truncation (only relevant for grid_definition_template_numbers 50-52).</span> </span>
<span class="py-lineno"> 290</span>  <span class="py-line"><span class="py-docstring"> For triangular truncation, all three of these numbers are the same.</span> </span>
<span class="py-lineno"> 291</span>  <span class="py-line"><span class="py-docstring"> @ivar latitude_of_southern_pole: the geographic latitude in degrees of the southern </span> </span>
<span class="py-lineno"> 292</span>  <span class="py-line"><span class="py-docstring"> pole of the coordinate system (for rotated lat/lon or gaussian grids).</span> </span>
<span class="py-lineno"> 293</span>  <span class="py-line"><span class="py-docstring"> @ivar longitude_of_southern_pole: the geographic longitude in degrees of the southern </span> </span>
<span class="py-lineno"> 294</span>  <span class="py-line"><span class="py-docstring"> pole of the coordinate system (for rotated lat/lon or gaussian grids).</span> </span>
<span class="py-lineno"> 295</span>  <span class="py-line"><span class="py-docstring"> @ivar angle_of_pole_rotation: The angle of rotation in degrees about the new </span> </span>
<span class="py-lineno"> 296</span>  <span class="py-line"><span class="py-docstring"> polar axis (measured clockwise when looking from the southern to the northern pole)</span> </span>
<span class="py-lineno"> 297</span>  <span class="py-line"><span class="py-docstring"> of the coordinate system. For rotated lat/lon or gaussian grids.</span> </span>
<span class="py-lineno"> 298</span>  <span class="py-line"><span class="py-docstring"> @ivar missing_value: primary missing value (for data_representation_template_numbers</span> </span>
<span class="py-lineno"> 299</span>  <span class="py-line"><span class="py-docstring"> 2 and 3).</span> </span>
<span class="py-lineno"> 300</span>  <span class="py-line"><span class="py-docstring"> @ivar missing_value2: secondary missing value (for data_representation_template_numbers</span> </span>
<span class="py-lineno"> 301</span>  <span class="py-line"><span class="py-docstring"> 2 and 3).</span> </span>
<span class="py-lineno"> 302</span>  <span class="py-line"><span class="py-docstring">    """</span> </span>
<a name="Grib2Message.__init__"></a><div id="Grib2Message.__init__-def"><span class="py-lineno"> 303</span> <a class="py-toggle" href="#" id="Grib2Message.__init__-toggle" onclick="toggle('Grib2Message.__init__'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Message-class.html#__init__">__init__</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span><span class="py-op">**</span><span class="py-param">kwargs</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Message.__init__-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Message.__init__-expanded"><span class="py-lineno"> 304</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 305</span>  <span class="py-line"><span class="py-docstring"> create a Grib2Decode class instance given a GRIB Edition 2 filename.</span> </span>
<span class="py-lineno"> 306</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno"> 307</span>  <span class="py-line"><span class="py-docstring"> (used by L{Grib2Decode} function - not directly called by user)</span> </span>
<span class="py-lineno"> 308</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno"> 309</span>  <span class="py-line">        <span class="py-keyword">for</span> <span class="py-name">k</span><span class="py-op">,</span><span class="py-name">v</span> <span class="py-keyword">in</span> <span class="py-name">kwargs</span><span class="py-op">.</span><span class="py-name">items</span><span class="py-op">(</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 310</span>  <span class="py-line">            <span class="py-name">setattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-name">k</span><span class="py-op">,</span><span class="py-name">v</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 311</span>  <span class="py-line">        <span class="py-comment"># set decoded, human-readable attributes.</span> </span>
<span class="py-lineno"> 312</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">discipline</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">discipline_code</span> </span>
<span class="py-lineno"> 313</span>  <span class="py-line">        <span class="py-name">pdtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">product_definition_template</span> </span>
<span class="py-lineno"> 314</span>  <span class="py-line">        <span class="py-name">pdtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">product_definition_template_number</span> </span>
<span class="py-lineno"> 315</span>  <span class="py-line">        <span class="py-name">gdsinfo</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_info</span> </span>
<span class="py-lineno"> 316</span>  <span class="py-line">        <span class="py-name">gdtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template_number</span> </span>
<span class="py-lineno"> 317</span>  <span class="py-line">        <span class="py-name">gdtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template</span> </span>
<span class="py-lineno"> 318</span>  <span class="py-line">        <span class="py-name">identsect</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">identification_section</span> </span>
<span class="py-lineno"> 319</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">discipline</span> <span class="py-op">=</span> <span class="py-name">_getdiscipline</span><span class="py-op">(</span><span class="py-name">discipline</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 320</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">product_definition_template_name</span> <span class="py-op">=</span> <span class="py-name">_getpdt</span><span class="py-op">(</span><span class="py-name">pdtnum</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 321</span>  <span class="py-line">        <span class="py-comment"># parameter.</span> </span>
<span class="py-lineno"> 322</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">paramname</span> <span class="py-op">=</span> <span class="py-name">_getparam</span><span class="py-op">(</span><span class="py-name">discipline</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 323</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter</span> <span class="py-op">=</span> <span class="py-name">paramname</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 324</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">paramname</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-string">''</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 325</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_units</span> <span class="py-op">=</span> <span class="py-name">paramname</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 326</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_category</span> <span class="py-op">=</span> <span class="py-name">_getparamcat</span><span class="py-op">(</span><span class="py-name">discipline</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 327</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_category_code</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 328</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_code</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 329</span>  <span class="py-line">        <span class="py-comment"># type of grid.</span> </span>
<span class="py-lineno"> 330</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 331</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">type_of_grid</span> <span class="py-op">=</span> <span class="py-name">sxn3</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">gdtnum</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 332</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 333</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">type_of_grid</span> <span class="py-op">=</span> <span class="py-string">'Quasi-regular '</span><span class="py-op">+</span><span class="py-name">sxn3</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">gdtnum</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 334</span>  <span class="py-line">        <span class="py-comment"># time.</span> </span>
<span class="py-lineno"> 335</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">yyyy</span><span class="py-op">,</span><span class="py-name">mm</span><span class="py-op">,</span><span class="py-name">dd</span><span class="py-op">,</span><span class="py-name">hh</span><span class="py-op">,</span><span class="py-name">min</span><span class="py-op">,</span><span class="py-name">ss</span> <span class="py-op">=</span> <span class="py-name">_getdate</span><span class="py-op">(</span><span class="py-name">identsect</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 336</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">min</span> <span class="py-op">==</span> <span class="py-number">0</span> <span class="py-keyword">and</span> <span class="py-name">ss</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 337</span>  <span class="py-line">            <span class="py-name">date</span> <span class="py-op">=</span> <span class="py-string">'%0.4i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">yyyy</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">mm</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">dd</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">hh</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 338</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">ss</span> <span class="py-op">==</span> <span class="py-number">0</span> <span class="py-keyword">and</span> <span class="py-name">min</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 339</span>  <span class="py-line">            <span class="py-name">date</span> <span class="py-op">=</span> <span class="py-string">'%0.4i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">yyyy</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">mm</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">dd</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">hh</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">min</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 340</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 341</span>  <span class="py-line">            <span class="py-name">date</span> <span class="py-op">=</span> <span class="py-string">'%0.4i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">yyyy</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">mm</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">dd</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">hh</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">min</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">'%0.2i'</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">ss</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 342</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">pdtnum</span> <span class="py-op">==</span> <span class="py-number">8</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 343</span>  <span class="py-line">           <span class="py-name">ftime</span> <span class="py-op">=</span> <span class="py-name">_getftime</span><span class="py-op">(</span><span class="py-name">pdtnum</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 344</span>  <span class="py-line">           <span class="py-name">ftimestring</span> <span class="py-op">=</span> <span class="py-name">string</span><span class="py-op">.</span><span class="py-name">lstrip</span><span class="py-op">(</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">' '</span><span class="py-op">+</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span><span class="py-op">+</span><span class="py-string">' '</span><span class="py-op">+</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">+</span><span class="py-string">' from '</span><span class="py-op">+</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">' '</span><span class="py-op">+</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">+</span><span class="py-string">' Forecast initialized '</span><span class="py-op">+</span><span class="py-name">date</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 345</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span>  </span>
<span class="py-lineno"> 346</span>  <span class="py-line">           <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 347</span>  <span class="py-line">               <span class="py-name">ftime</span> <span class="py-op">=</span> <span class="py-name">_getftime</span><span class="py-op">(</span><span class="py-name">pdtnum</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 348</span>  <span class="py-line">               <span class="py-name">ftimestring</span> <span class="py-op">=</span> <span class="py-name">string</span><span class="py-op">.</span><span class="py-name">lstrip</span><span class="py-op">(</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">' '</span><span class="py-op">+</span><span class="py-name">ftime</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">+</span><span class="py-string">' Forecast initialized '</span><span class="py-op">+</span><span class="py-name">date</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 349</span>  <span class="py-line">           <span class="py-keyword">except</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 350</span>  <span class="py-line">               <span class="py-name">ftimestring</span><span class="py-op">=</span><span class="py-name">None</span> </span>
<span class="py-lineno"> 351</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">ftimestring</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 352</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">forecast_time</span> <span class="py-op">=</span> <span class="py-name">ftimestring</span> </span>
<span class="py-lineno"> 353</span>  <span class="py-line">        <span class="py-comment"># vertical level.</span> </span>
<span class="py-lineno"> 354</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">levinfo</span> <span class="py-op">=</span> <span class="py-name">_getvertlevel</span><span class="py-op">(</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 355</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 356</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">len</span><span class="py-op">(</span><span class="py-name">levinfo</span><span class="py-op">)</span> <span class="py-op">&gt;</span> <span class="py-number">3</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 357</span>  <span class="py-line">                <span class="py-name">levs</span> <span class="py-op">=</span> <span class="py-string">'%g-%g '</span><span class="py-op">%</span><span class="py-op">(</span><span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 358</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 359</span>  <span class="py-line">                <span class="py-name">levs</span> <span class="py-op">=</span> <span class="py-string">'%g '</span><span class="py-op">%</span><span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 360</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 361</span>  <span class="py-line">            <span class="py-name">levs</span> <span class="py-op">=</span> <span class="py-string">''</span> </span>
<span class="py-lineno"> 362</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">levs</span><span class="py-op">+</span><span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-string">''</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 363</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level</span> <span class="py-op">=</span> <span class="py-name">levs</span><span class="py-op">+</span><span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 364</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-string">''</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 365</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level_descriptor</span> <span class="py-op">=</span> <span class="py-name">levinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 366</span>  <span class="py-line">        <span class="py-comment"># ensemble info.</span> </span>
<span class="py-lineno"> 367</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">pdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">1</span><span class="py-op">,</span><span class="py-number">11</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 368</span>  <span class="py-line">            <span class="py-name">ensname</span><span class="py-op">,</span><span class="py-name">pertnum</span><span class="py-op">,</span><span class="py-name">nmembers</span> <span class="py-op">=</span> <span class="py-name">_getensinfo</span><span class="py-op">(</span><span class="py-name">pdtnum</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 369</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">ensemble_info</span> <span class="py-op">=</span> <span class="py-name">ensname</span><span class="py-op">+</span><span class="py-string">' member '</span><span class="py-op">+</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">pertnum</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">' of '</span><span class="py-op">+</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">nmembers</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 370</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">pdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">2</span><span class="py-op">,</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 371</span>  <span class="py-line">            <span class="py-name">ensname</span><span class="py-op">,</span><span class="py-name">pertnum</span><span class="py-op">,</span><span class="py-name">nmembers</span> <span class="py-op">=</span> <span class="py-name">_getensinfo</span><span class="py-op">(</span><span class="py-name">pdtnum</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 372</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">ensemble_info</span> <span class="py-op">=</span> <span class="py-name">ensname</span><span class="py-op">+</span><span class="py-string">' from a '</span><span class="py-op">+</span><span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">nmembers</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">' member ensemble'</span> </span>
<span class="py-lineno"> 373</span>  <span class="py-line">        <span class="py-comment"># shape of the earth.</span> </span>
<span class="py-lineno"> 374</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-keyword">not</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">50</span><span class="py-op">,</span><span class="py-number">51</span><span class="py-op">,</span><span class="py-number">52</span><span class="py-op">,</span><span class="py-number">1200</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 375</span>  <span class="py-line">            <span class="py-name">earthR</span> <span class="py-op">=</span> <span class="py-name">sxn3</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 376</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">earthR</span> <span class="py-op">==</span> <span class="py-string">'Reserved'</span><span class="py-op">:</span> <span class="py-name">earthR</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 377</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 378</span>  <span class="py-line">            <span class="py-name">earthR</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 379</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">_isString</span><span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">.</span><span class="py-name">startswith</span><span class="py-op">(</span><span class="py-string">'Reserved'</span><span class="py-op">)</span> <span class="py-keyword">or</span> <span class="py-name">earthR</span><span class="py-op">==</span><span class="py-string">'Missing'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 380</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-name">earthR</span> </span>
<span class="py-lineno"> 381</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 382</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 383</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">_isString</span><span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">earthR</span><span class="py-op">.</span><span class="py-name">startswith</span><span class="py-op">(</span><span class="py-string">'Spherical'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 384</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-name">earthR</span> </span>
<span class="py-lineno"> 385</span>  <span class="py-line">            <span class="py-name">scaledearthR</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 386</span>  <span class="py-line">            <span class="py-name">earthRscale</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 387</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">math</span><span class="py-op">.</span><span class="py-name">pow</span><span class="py-op">(</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-op">-</span><span class="py-name">earthRscale</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">scaledearthR</span> </span>
<span class="py-lineno"> 388</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> </span>
<span class="py-lineno"> 389</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">_isString</span><span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">earthR</span><span class="py-op">.</span><span class="py-name">startswith</span><span class="py-op">(</span><span class="py-string">'OblateSpheroid'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 390</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-name">earthR</span> </span>
<span class="py-lineno"> 391</span>  <span class="py-line">            <span class="py-name">scaledearthRmajor</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 392</span>  <span class="py-line">            <span class="py-name">earthRmajorscale</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 393</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">math</span><span class="py-op">.</span><span class="py-name">pow</span><span class="py-op">(</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-op">-</span><span class="py-name">earthRmajorscale</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">scaledearthRmajor</span> </span>
<span class="py-lineno"> 394</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span><span class="py-op">*</span><span class="py-number">1000.</span> <span class="py-comment"># convert to m from km</span> </span>
<span class="py-lineno"> 395</span>  <span class="py-line">            <span class="py-name">scaledearthRminor</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 396</span>  <span class="py-line">            <span class="py-name">earthRminorscale</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">5</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 397</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">math</span><span class="py-op">.</span><span class="py-name">pow</span><span class="py-op">(</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-op">-</span><span class="py-name">earthRminorscale</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">scaledearthRminor</span> </span>
<span class="py-lineno"> 398</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span><span class="py-op">*</span><span class="py-number">1000.</span> <span class="py-comment"># convert to m from km</span> </span>
<span class="py-lineno"> 399</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">_isString</span><span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">earthR</span><span class="py-op">.</span><span class="py-name">startswith</span><span class="py-op">(</span><span class="py-string">'WGS84'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 400</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-name">earthR</span> </span>
<span class="py-lineno"> 401</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-number">6378137.0</span> </span>
<span class="py-lineno"> 402</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-number">6356752.3142</span> </span>
<span class="py-lineno"> 403</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">isinstance</span><span class="py-op">(</span><span class="py-name">earthR</span><span class="py-op">,</span><span class="py-name">tuple</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 404</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-string">'OblateSpheroid'</span> </span>
<span class="py-lineno"> 405</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">earthR</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 406</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">earthR</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 407</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span>  </span>
<span class="py-lineno"> 408</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">earthR</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 409</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">shape_of_earth</span> <span class="py-op">=</span> <span class="py-string">'Spherical'</span> </span>
<span class="py-lineno"> 410</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">=</span> <span class="py-name">earthR</span> </span>
<span class="py-lineno"> 411</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> </span>
<span class="py-lineno"> 412</span>  <span class="py-line">        <span class="py-comment"># grid information</span> </span>
<span class="py-lineno"> 413</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">reggrid</span> <span class="py-op">=</span> <span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-number">0</span> <span class="py-comment"># gdsinfo[2]=0 means regular 2-d grid</span> </span>
<span class="py-lineno"> 414</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">reggrid</span> <span class="py-keyword">and</span> <span class="py-name">gdtnum</span> <span class="py-keyword">not</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">50</span><span class="py-op">,</span><span class="py-number">51</span><span class="py-op">,</span><span class="py-number">52</span><span class="py-op">,</span><span class="py-number">53</span><span class="py-op">,</span><span class="py-number">100</span><span class="py-op">,</span><span class="py-number">120</span><span class="py-op">,</span><span class="py-number">1000</span><span class="py-op">,</span><span class="py-number">1200</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 415</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">7</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 416</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">8</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 417</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-keyword">not</span> <span class="py-name">reggrid</span> <span class="py-keyword">and</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">40</span><span class="py-op">:</span> <span class="py-comment"># 'reduced' gaussian grid.</span> </span>
<span class="py-lineno"> 418</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">8</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 419</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">0</span> <span class="py-keyword">or</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">1</span><span class="py-op">:</span> <span class="py-comment"># regular lat/lon grid</span> </span>
<span class="py-lineno"> 420</span>  <span class="py-line">            <span class="py-name">scalefact</span> <span class="py-op">=</span> <span class="py-name">float</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 421</span>  <span class="py-line">            <span class="py-name">divisor</span> <span class="py-op">=</span> <span class="py-name">float</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 422</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">scalefact</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> <span class="py-name">scalefact</span> <span class="py-op">=</span> <span class="py-number">1.</span> </span>
<span class="py-lineno"> 423</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">divisor</span> <span class="py-op">&lt;=</span> <span class="py-number">0</span><span class="py-op">:</span> <span class="py-name">divisor</span> <span class="py-op">=</span> <span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 424</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">11</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 425</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 426</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 427</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 428</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 429</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 430</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">&gt;</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 431</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-op">-</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> </span>
<span class="py-lineno"> 432</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">&gt;</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 433</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-op">-</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 434</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 435</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 436</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_of_southern_pole</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">19</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 437</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_of_southern_pole</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">20</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 438</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">angle_of_pole_rotation</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">21</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 439</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">10</span><span class="py-op">:</span> <span class="py-comment"># mercator</span> </span>
<span class="py-lineno"> 440</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 441</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 442</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 443</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 444</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e3</span> </span>
<span class="py-lineno"> 445</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span><span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e3</span> </span>
<span class="py-lineno"> 446</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_ts</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 447</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-number">0.5</span><span class="py-op">*</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span><span class="py-op">+</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 448</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'merc'</span> </span>
<span class="py-lineno"> 449</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 450</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">20</span><span class="py-op">:</span> <span class="py-comment"># stereographic</span> </span>
<span class="py-lineno"> 451</span>  <span class="py-line">            <span class="py-name">projflag</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 452</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 453</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 454</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_ts</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 455</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">projflag</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 456</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-number">90</span> </span>
<span class="py-lineno"> 457</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">projflag</span> <span class="py-op">==</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 458</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-op">-</span><span class="py-number">90</span> </span>
<span class="py-lineno"> 459</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 460</span>  <span class="py-line">                <span class="py-keyword">raise</span> <span class="py-name">ValueError</span><span class="py-op">,</span><span class="py-string">'Invalid projection center flag = %s'</span> <span class="py-op">%</span> <span class="py-name">projflag</span> </span>
<span class="py-lineno"> 461</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 462</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 463</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 464</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'stere'</span> </span>
<span class="py-lineno"> 465</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 466</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">30</span><span class="py-op">:</span> <span class="py-comment"># lambert conformal</span> </span>
<span class="py-lineno"> 467</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 468</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 469</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 470</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 471</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_1</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 472</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_2</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">19</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 473</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 474</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 475</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'lcc'</span> </span>
<span class="py-lineno"> 476</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 477</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">31</span><span class="py-op">:</span> <span class="py-comment"># albers equal area.</span> </span>
<span class="py-lineno"> 478</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 479</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 480</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 481</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 482</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_1</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 483</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_2</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">19</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 484</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 485</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 486</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'aea'</span> </span>
<span class="py-lineno"> 487</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 488</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">40</span> <span class="py-keyword">or</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">41</span><span class="py-op">:</span> <span class="py-comment"># gaussian grid.</span> </span>
<span class="py-lineno"> 489</span>  <span class="py-line">            <span class="py-name">scalefact</span> <span class="py-op">=</span> <span class="py-name">float</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 490</span>  <span class="py-line">            <span class="py-name">divisor</span> <span class="py-op">=</span> <span class="py-name">float</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 491</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">scalefact</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> <span class="py-name">scalefact</span> <span class="py-op">=</span> <span class="py-number">1.</span> </span>
<span class="py-lineno"> 492</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">divisor</span> <span class="py-op">&lt;=</span> <span class="py-number">0</span><span class="py-op">:</span> <span class="py-name">divisor</span> <span class="py-op">=</span> <span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 493</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_between_pole_and_equator</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 494</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">11</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 495</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 496</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 497</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 498</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">reggrid</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 499</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 500</span>  <span class="py-line">                <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span> <span class="py-op">&gt;</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 501</span>  <span class="py-line">                    <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-op">-</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 502</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 503</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">41</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 504</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_of_southern_pole</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">19</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 505</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_of_southern_pole</span> <span class="py-op">=</span> <span class="py-name">scalefact</span><span class="py-op">*</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">20</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-name">divisor</span> </span>
<span class="py-lineno"> 506</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">angle_of_pole_rotation</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">21</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 507</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">50</span><span class="py-op">:</span> <span class="py-comment"># spectral coefficients.</span> </span>
<span class="py-lineno"> 508</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">spectral_truncation_parameters</span> <span class="py-op">=</span> <span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 509</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-name">None</span><span class="py-op">]</span> <span class="py-comment"># doesn't apply</span> </span>
<span class="py-lineno"> 510</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">90</span><span class="py-op">:</span> <span class="py-comment"># near-sided vertical perspective satellite projection</span> </span>
<span class="py-lineno"> 511</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 512</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 513</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_h</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">*</span> <span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">18</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 514</span>  <span class="py-line">            <span class="py-name">dx</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 515</span>  <span class="py-line">            <span class="py-name">dy</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 516</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">==</span> <span class="py-number">0.</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 517</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'geos'</span> </span>
<span class="py-lineno"> 518</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_h</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_h</span> <span class="py-op">-</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> </span>
<span class="py-lineno"> 519</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-number">2.</span><span class="py-op">*</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span><span class="py-op">/</span><span class="py-name">dx</span> </span>
<span class="py-lineno"> 520</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-number">2.</span><span class="py-op">*</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span><span class="py-op">/</span><span class="py-name">dy</span> </span>
<span class="py-lineno"> 521</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> <span class="py-op">!=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 522</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'npers'</span> </span>
<span class="py-lineno"> 523</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-number">2.</span><span class="py-op">*</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span><span class="py-op">/</span><span class="py-name">dx</span> </span>
<span class="py-lineno"> 524</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-number">2.</span><span class="py-op">*</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span><span class="py-op">/</span><span class="py-name">dy</span> </span>
<span class="py-lineno"> 525</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 526</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">110</span><span class="py-op">:</span> <span class="py-comment"># azimuthal equidistant.</span> </span>
<span class="py-lineno"> 527</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 528</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1.e6</span> </span>
<span class="py-lineno"> 529</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 530</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> <span class="py-op">=</span> <span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span><span class="py-op">/</span><span class="py-number">1000.</span> </span>
<span class="py-lineno"> 531</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> <span class="py-op">=</span> <span class="py-string">'aeqd'</span> </span>
<span class="py-lineno"> 532</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span> <span class="py-op">=</span> <span class="py-name">_dec2bin</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">:</span><span class="py-number">4</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 533</span>  <span class="py-line">        <span class="py-comment"># missing value.</span> </span>
<span class="py-lineno"> 534</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">drtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">data_representation_template_number</span> </span>
<span class="py-lineno"> 535</span>  <span class="py-line">        <span class="py-name">drtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">data_representation_template</span> </span>
<span class="py-lineno"> 536</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-op">(</span><span class="py-name">drtnum</span> <span class="py-op">==</span> <span class="py-number">2</span> <span class="py-keyword">or</span> <span class="py-name">drtnum</span> <span class="py-op">==</span> <span class="py-number">3</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 537</span>  <span class="py-line">            <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">missing_value</span> <span class="py-op">=</span> <span class="py-name">_getieeeint</span><span class="py-op">(</span><span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-number">7</span><span class="py-op">]</span><span class="py-op">)</span>  </span>
<span class="py-lineno"> 538</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-number">2</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 539</span>  <span class="py-line">                <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">missing_value2</span> <span class="py-op">=</span> <span class="py-name">_getieeeint</span><span class="py-op">(</span><span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-number">8</span><span class="py-op">]</span><span class="py-op">)</span>  </span>
<span class="py-lineno"> 540</span>  <span class="py-line">        <span class="py-comment"># inventory string.</span> </span>
<span class="py-lineno"> 541</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-keyword">not</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'parameter_units'</span><span class="py-op">)</span> <span class="py-keyword">or</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_units</span><span class="py-op">==</span><span class="py-string">''</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 542</span>  <span class="py-line">            <span class="py-name">paramstring</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter</span> </span>
<span class="py-lineno"> 543</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 544</span>  <span class="py-line">            <span class="py-name">paramstring</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter</span><span class="py-op">+</span><span class="py-string">' ['</span><span class="py-op">+</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">parameter_units</span><span class="py-op">+</span><span class="py-string">']'</span> </span>
<span class="py-lineno"> 545</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'forecast_time'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 546</span>  <span class="py-line">            <span class="py-name">fcsttimestring</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">forecast_time</span> </span>
<span class="py-lineno"> 547</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 548</span>  <span class="py-line">            <span class="py-name">fcsttimestring</span> <span class="py-op">=</span> <span class="py-string">''</span> </span>
<span class="py-lineno"> 549</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'vertical_level'</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level_descriptor</span> <span class="py-op">!=</span> <span class="py-string">''</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 550</span>  <span class="py-line">            <span class="py-name">levstring</span> <span class="py-op">=</span> <span class="py-name">string</span><span class="py-op">.</span><span class="py-name">lstrip</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level</span><span class="py-op">+</span><span class="py-string">' ('</span><span class="py-op">+</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level_descriptor</span><span class="py-op">+</span><span class="py-string">')'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 551</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 552</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'vertical_level_descriptor'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 553</span>  <span class="py-line">                <span class="py-name">levstring</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">vertical_level_descriptor</span> </span>
<span class="py-lineno"> 554</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 555</span>  <span class="py-line">                <span class="py-name">levstring</span> <span class="py-op">=</span> <span class="py-string">''</span> </span>
<span class="py-lineno"> 556</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'ensemble_info'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 557</span>  <span class="py-line">            <span class="py-name">ensstring</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">ensemble_info</span> </span>
<span class="py-lineno"> 558</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 559</span>  <span class="py-line">            <span class="py-name">ensstring</span> <span class="py-op">=</span> <span class="py-string">''</span> </span>
<span class="py-lineno"> 560</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_inventory</span> <span class="py-op">=</span> <span class="py-name">repr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_grib_message_number</span><span class="py-op">)</span><span class="py-op">+</span><span class="py-string">':'</span><span class="py-op">+</span><span class="py-name">paramstring</span><span class="py-op">+</span><span class="py-string">':'</span><span class="py-op">+</span><span class="py-name">levstring</span><span class="py-op">+</span><span class="py-string">':'</span><span class="py-op">+</span><span class="py-name">fcsttimestring</span><span class="py-op">+</span><span class="py-string">':'</span><span class="py-op">+</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">type_of_grid</span><span class="py-op">+</span><span class="py-string">':'</span><span class="py-op">+</span><span class="py-name">ensstring</span> </span>
</div><span class="py-lineno"> 561</span>  <span class="py-line"> </span>
<a name="Grib2Message.__repr__"></a><div id="Grib2Message.__repr__-def"><span class="py-lineno"> 562</span> <a class="py-toggle" href="#" id="Grib2Message.__repr__-toggle" onclick="toggle('Grib2Message.__repr__'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Message-class.html#__repr__">__repr__</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Message.__repr__-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Message.__repr__-expanded"><span class="py-lineno"> 563</span>  <span class="py-line">        <span class="py-docstring">"""print a summary string describiing the contents of the GRIB2 message"""</span> </span>
<span class="py-lineno"> 564</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_inventory</span> </span>
</div><span class="py-lineno"> 565</span>  <span class="py-line">         </span>
<a name="Grib2Message.data"></a><div id="Grib2Message.data-def"><span class="py-lineno"> 566</span> <a class="py-toggle" href="#" id="Grib2Message.data-toggle" onclick="toggle('Grib2Message.data'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Message-class.html#data">data</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span><span class="py-param">fill_value</span><span class="py-op">=</span><span class="py-number">1.e30</span><span class="py-op">,</span><span class="py-param">masked_array</span><span class="py-op">=</span><span class="py-name">False</span><span class="py-op">,</span><span class="py-param">expand</span><span class="py-op">=</span><span class="py-name">True</span><span class="py-op">,</span><span class="py-param">order</span><span class="py-op">=</span><span class="py-name">None</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Message.data-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Message.data-expanded"><span class="py-lineno"> 567</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 568</span>  <span class="py-line"><span class="py-docstring"> returns an unpacked data grid.</span> </span>
<span class="py-lineno"> 569</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno"> 570</span>  <span class="py-line"><span class="py-docstring"> @keyword fill_value: missing or masked data is filled with this value</span> </span>
<span class="py-lineno"> 571</span>  <span class="py-line"><span class="py-docstring"> (default 1.e30).</span> </span>
<span class="py-lineno"> 572</span>  <span class="py-line"><span class="py-docstring"> @keyword masked_array: if True, return masked array if there is bitmap</span> </span>
<span class="py-lineno"> 573</span>  <span class="py-line"><span class="py-docstring"> for missing or masked data (default False).</span> </span>
<span class="py-lineno"> 574</span>  <span class="py-line"><span class="py-docstring"> @keyword expand:  if True (default), ECMWF 'reduced' gaussian grids are</span> </span>
<span class="py-lineno"> 575</span>  <span class="py-line"><span class="py-docstring"> expanded to regular gaussian grids.</span> </span>
<span class="py-lineno"> 576</span>  <span class="py-line"><span class="py-docstring"> @keyword order: if 1, linear interpolation is used for expanding reduced</span> </span>
<span class="py-lineno"> 577</span>  <span class="py-line"><span class="py-docstring"> gaussian grids.  if 0, nearest neighbor interpolation is used. Default </span> </span>
<span class="py-lineno"> 578</span>  <span class="py-line"><span class="py-docstring"> is 0 if grid has missing or bitmapped values, 1 otherwise.</span> </span>
<span class="py-lineno"> 579</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno"> 580</span>  <span class="py-line"><span class="py-docstring"> @return: C{B{data}}, a float32 numpy regular or masked array</span> </span>
<span class="py-lineno"> 581</span>  <span class="py-line"><span class="py-docstring"> with shape (nlats,lons) containing the request grid.</span> </span>
<span class="py-lineno"> 582</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno"> 583</span>  <span class="py-line">        <span class="py-comment"># make sure scan mode is supported.</span> </span>
<span class="py-lineno"> 584</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment"># if there is no 'scanmodeflags', then grid is not supported.</span> </span>
<span class="py-lineno"> 585</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-keyword">not</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'scanmodeflags'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 586</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">ValueError</span><span class="py-op">(</span><span class="py-string">'unsupported grid definition template number %s'</span><span class="py-op">%</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template_number</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 587</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 588</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 589</span>  <span class="py-line">                <span class="py-keyword">raise</span> <span class="py-name">ValueError</span><span class="py-op">(</span><span class="py-string">'unsupported scan mode (bit 3==1 in Table 3.4: column-major storage order'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 590</span>  <span class="py-line">        <span class="py-name">bitmapflag</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">bitmap_indicator_flag</span> </span>
<span class="py-lineno"> 591</span>  <span class="py-line">        <span class="py-name">drtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">data_representation_template_number</span> </span>
<span class="py-lineno"> 592</span>  <span class="py-line">        <span class="py-name">drtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">data_representation_template</span> </span>
<span class="py-lineno"> 593</span>  <span class="py-line">        <span class="py-comment"># default order=0 is missing values or bitmap exists.</span> </span>
<span class="py-lineno"> 594</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">order</span> <span class="py-keyword">is</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 595</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-op">(</span><span class="py-op">(</span><span class="py-name">drtnum</span> <span class="py-op">==</span> <span class="py-number">3</span> <span class="py-keyword">or</span> <span class="py-name">drtnum</span> <span class="py-op">==</span> <span class="py-number">2</span><span class="py-op">)</span> <span class="py-keyword">and</span> <span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-number">0</span><span class="py-op">)</span> <span class="py-keyword">or</span> <span class="py-name">bitmapflag</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 596</span>  <span class="py-line">                <span class="py-name">order</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 597</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 598</span>  <span class="py-line">                <span class="py-name">order</span> <span class="py-op">=</span> <span class="py-number">1</span> </span>
<span class="py-lineno"> 599</span>  <span class="py-line">        <span class="py-name">f</span> <span class="py-op">=</span> <span class="py-name">open</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_grib_filename</span><span class="py-op">,</span><span class="py-string">'rb'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 600</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_grib_message_byteoffset</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 601</span>  <span class="py-line">        <span class="py-name">gribmsg</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_grib_message_length</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 602</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">close</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 603</span>  <span class="py-line">        <span class="py-name">gdtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template_number</span> </span>
<span class="py-lineno"> 604</span>  <span class="py-line">        <span class="py-name">gdtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template</span> </span>
<span class="py-lineno"> 605</span>  <span class="py-line">        <span class="py-name">ndpts</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">number_of_data_points_to_unpack</span> </span>
<span class="py-lineno"> 606</span>  <span class="py-line">        <span class="py-name">gdsinfo</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_info</span> </span>
<span class="py-lineno"> 607</span>  <span class="py-line">        <span class="py-name">ngrdpts</span> <span class="py-op">=</span> <span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 608</span>  <span class="py-line">        <span class="py-name">ipos</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_section7_byte_offset</span> </span>
<span class="py-lineno"> 609</span>  <span class="py-line">        <span class="py-name">fld1</span><span class="py-op">=</span><span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack7</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">gdtnum</span><span class="py-op">,</span><span class="py-name">gdtmpl</span><span class="py-op">,</span><span class="py-name">drtnum</span><span class="py-op">,</span><span class="py-name">drtmpl</span><span class="py-op">,</span><span class="py-name">ndpts</span><span class="py-op">,</span><span class="py-name">ipos</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 610</span>  <span class="py-line">        <span class="py-comment"># apply bitmap.</span> </span>
<span class="py-lineno"> 611</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">bitmapflag</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 612</span>  <span class="py-line">            <span class="py-name">bitmap</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">_bitmap</span> </span>
<span class="py-lineno"> 613</span>  <span class="py-line">            <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">fill_value</span><span class="py-op">*</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">ones</span><span class="py-op">(</span><span class="py-name">ngrdpts</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 614</span>  <span class="py-line">            <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">put</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">nonzero</span><span class="py-op">(</span><span class="py-name">bitmap</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">fld1</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 615</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">masked_array</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 616</span>  <span class="py-line">                <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">ma</span><span class="py-op">.</span><span class="py-name">masked_values</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-name">fill_value</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 617</span>  <span class="py-line">        <span class="py-comment"># missing values instead of bitmap</span> </span>
<span class="py-lineno"> 618</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">elif</span> <span class="py-name">masked_array</span> <span class="py-keyword">and</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'missing_value'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 619</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span> <span class="py-string">'missing_value2'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 620</span>  <span class="py-line">                <span class="py-name">mask</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">logical_or</span><span class="py-op">(</span><span class="py-name">fld1</span> <span class="py-op">==</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">missing_value</span><span class="py-op">,</span> <span class="py-name">fld1</span> <span class="py-op">==</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">missing_value2</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 621</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 622</span>  <span class="py-line">                <span class="py-name">mask</span> <span class="py-op">=</span> <span class="py-name">fld1</span> <span class="py-op">==</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">missing_value</span> </span>
<span class="py-lineno"> 623</span>  <span class="py-line">            <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">ma</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">fld1</span><span class="py-op">,</span><span class="py-name">mask</span><span class="py-op">=</span><span class="py-name">mask</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 624</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 625</span>  <span class="py-line">            <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">fld1</span> </span>
<span class="py-lineno"> 626</span>  <span class="py-line">        <span class="py-name">nx</span> <span class="py-op">=</span> <span class="py-name">None</span><span class="py-op">;</span> <span class="py-name">ny</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 627</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'points_in_x_direction'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 628</span>  <span class="py-line">            <span class="py-name">nx</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_x_direction</span> </span>
<span class="py-lineno"> 629</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">,</span><span class="py-string">'points_in_y_direction'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 630</span>  <span class="py-line">            <span class="py-name">ny</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> </span>
<span class="py-lineno"> 631</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">nx</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span> <span class="py-keyword">and</span> <span class="py-name">ny</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> <span class="py-comment"># rectangular grid.</span> </span>
<span class="py-lineno"> 632</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-string">'mask'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 633</span>  <span class="py-line">                <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">ma</span><span class="py-op">.</span><span class="py-name">reshape</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">,</span><span class="py-name">nx</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 634</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 635</span>  <span class="py-line">                <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">reshape</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">,</span><span class="py-name">nx</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 636</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 637</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> <span class="py-keyword">and</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">40</span><span class="py-op">:</span> <span class="py-comment"># ECMWF 'reduced' global gaussian grid.</span> </span>
<span class="py-lineno"> 638</span>  <span class="py-line">                <span class="py-keyword">if</span> <span class="py-name">expand</span><span class="py-op">:</span>  </span>
<span class="py-lineno"> 639</span>  <span class="py-line">                    <span class="py-name">nx</span> <span class="py-op">=</span> <span class="py-number">2</span><span class="py-op">*</span><span class="py-name">ny</span> </span>
<span class="py-lineno"> 640</span>  <span class="py-line">                    <span class="py-name">lonsperlat</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_list</span> </span>
<span class="py-lineno"> 641</span>  <span class="py-line">                    <span class="py-keyword">if</span> <span class="py-name">hasattr</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-string">'mask'</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 642</span>  <span class="py-line">                        <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">ma</span><span class="py-op">.</span><span class="py-name">filled</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 643</span>  <span class="py-line">                        <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">_redtoreg</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">,</span> <span class="py-name">lonsperlat</span><span class="py-op">,</span> <span class="py-name">fld</span><span class="py-op">,</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">,</span> <span class="py-name">order</span><span class="py-op">=</span><span class="py-name">order</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 644</span>  <span class="py-line">                        <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">ma</span><span class="py-op">.</span><span class="py-name">masked_values</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">,</span><span class="py-name">fill_value</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 645</span>  <span class="py-line">                    <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 646</span>  <span class="py-line">                        <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">_redtoreg</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">,</span> <span class="py-name">lonsperlat</span><span class="py-op">,</span> <span class="py-name">fld</span><span class="py-op">,</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">,</span><span class="py-name">order</span><span class="py-op">=</span><span class="py-name">order</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 647</span>  <span class="py-line">        <span class="py-comment"># adjacent rows scan in opposite direction.</span> </span>
<span class="py-lineno"> 648</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment"># (flip every other row)</span> </span>
<span class="py-lineno"> 649</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">if</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">scanmodeflags</span><span class="py-op">[</span><span class="py-number">3</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 650</span>  <span class="py-line">            <span class="py-name">fldsave</span> <span class="py-op">=</span> <span class="py-name">fld</span><span class="py-op">.</span><span class="py-name">astype</span><span class="py-op">(</span><span class="py-string">'f'</span><span class="py-op">)</span> <span class="py-comment"># casting makes a copy</span> </span>
<span class="py-lineno"> 651</span>  <span class="py-line">            <span class="py-name">fld</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">:</span><span class="py-op">:</span><span class="py-number">2</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">]</span> <span class="py-op">=</span> <span class="py-name">fldsave</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">:</span><span class="py-op">:</span><span class="py-number">2</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">:</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 652</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">fld</span> </span>
</div><span class="py-lineno"> 653</span>  <span class="py-line"> </span>
<a name="Grib2Message.grid"></a><div id="Grib2Message.grid-def"><span class="py-lineno"> 654</span> <a class="py-toggle" href="#" id="Grib2Message.grid-toggle" onclick="toggle('Grib2Message.grid'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Message-class.html#grid">grid</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Message.grid-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Message.grid-expanded"><span class="py-lineno"> 655</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 656</span>  <span class="py-line"><span class="py-docstring"> return lats,lons (in degrees) of grid.</span> </span>
<span class="py-lineno"> 657</span>  <span class="py-line"><span class="py-docstring"> currently can handle reg. lat/lon, global gaussian, mercator, stereographic,</span> </span>
<span class="py-lineno"> 658</span>  <span class="py-line"><span class="py-docstring"> lambert conformal, albers equal-area, space-view and azimuthal </span> </span>
<span class="py-lineno"> 659</span>  <span class="py-line"><span class="py-docstring"> equidistant grids.</span> </span>
<span class="py-lineno"> 660</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 661</span>  <span class="py-line"><span class="py-docstring"> @return: C{B{lats},B{lons}}, float32 numpy arrays </span> </span>
<span class="py-lineno"> 662</span>  <span class="py-line"><span class="py-docstring"> containing latitudes and longitudes of grid (in degrees).</span> </span>
<span class="py-lineno"> 663</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno"> 664</span>  <span class="py-line">        <span class="py-name">gdsinfo</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_info</span> </span>
<span class="py-lineno"> 665</span>  <span class="py-line">        <span class="py-name">gdtnum</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template_number</span> </span>
<span class="py-lineno"> 666</span>  <span class="py-line">        <span class="py-name">gdtmpl</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">grid_definition_template</span> </span>
<span class="py-lineno"> 667</span>  <span class="py-line">        <span class="py-name">reggrid</span> <span class="py-op">=</span> <span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-number">0</span> <span class="py-comment"># gdsinfo[2]=0 means regular 2-d grid</span> </span>
<span class="py-lineno"> 668</span>  <span class="py-line">        <span class="py-name">projparams</span> <span class="py-op">=</span> <span class="py-op">{</span><span class="py-op">}</span> </span>
<span class="py-lineno"> 669</span>  <span class="py-line">        <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'a'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRmajor</span> </span>
<span class="py-lineno"> 670</span>  <span class="py-line">        <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'b'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">earthRminor</span> </span>
<span class="py-lineno"> 671</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> <span class="py-comment"># regular lat/lon grid</span> </span>
<span class="py-lineno"> 672</span>  <span class="py-line">            <span class="py-name">lon1</span><span class="py-op">,</span> <span class="py-name">lat1</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> </span>
<span class="py-lineno"> 673</span>  <span class="py-line">            <span class="py-name">lon2</span><span class="py-op">,</span> <span class="py-name">lat2</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> </span>
<span class="py-lineno"> 674</span>  <span class="py-line">            <span class="py-name">delon</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 675</span>  <span class="py-line">            <span class="py-name">delat</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> </span>
<span class="py-lineno"> 676</span>  <span class="py-line">            <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">arange</span><span class="py-op">(</span><span class="py-name">lat1</span><span class="py-op">,</span><span class="py-name">lat2</span><span class="py-op">+</span><span class="py-name">delat</span><span class="py-op">,</span><span class="py-name">delat</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 677</span>  <span class="py-line">            <span class="py-name">lons</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">arange</span><span class="py-op">(</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lon2</span><span class="py-op">+</span><span class="py-name">delon</span><span class="py-op">,</span><span class="py-name">delon</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 678</span>  <span class="py-line">            <span class="py-name">lons</span><span class="py-op">,</span><span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">_meshgrid</span><span class="py-op">(</span><span class="py-name">lons</span><span class="py-op">,</span><span class="py-name">lats</span><span class="py-op">)</span> <span class="py-comment"># make 2-d arrays.</span> </span>
<span class="py-lineno"> 679</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">40</span><span class="py-op">:</span> <span class="py-comment"># gaussian grid (only works for global!)</span> </span>
<span class="py-lineno"> 680</span>  <span class="py-line">            <span class="py-name">lon1</span><span class="py-op">,</span> <span class="py-name">lat1</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> </span>
<span class="py-lineno"> 681</span>  <span class="py-line">            <span class="py-name">lon2</span><span class="py-op">,</span> <span class="py-name">lat2</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> </span>
<span class="py-lineno"> 682</span>  <span class="py-line">            <span class="py-name">nlats</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> </span>
<span class="py-lineno"> 683</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-keyword">not</span> <span class="py-name">reggrid</span><span class="py-op">:</span> <span class="py-comment"># ECMWF 'reduced' gaussian grid.</span> </span>
<span class="py-lineno"> 684</span>  <span class="py-line">                <span class="py-name">nlons</span> <span class="py-op">=</span> <span class="py-number">2</span><span class="py-op">*</span><span class="py-name">nlats</span> </span>
<span class="py-lineno"> 685</span>  <span class="py-line">                <span class="py-name">delon</span> <span class="py-op">=</span> <span class="py-number">360.</span><span class="py-op">/</span><span class="py-name">nlons</span> </span>
<span class="py-lineno"> 686</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 687</span>  <span class="py-line">                <span class="py-name">nlons</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_x_direction</span> </span>
<span class="py-lineno"> 688</span>  <span class="py-line">                <span class="py-name">delon</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 689</span>  <span class="py-line">            <span class="py-name">lons</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">arange</span><span class="py-op">(</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lon2</span><span class="py-op">+</span><span class="py-name">delon</span><span class="py-op">,</span><span class="py-name">delon</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 690</span>  <span class="py-line">            <span class="py-comment"># compute gaussian lats (north to south)</span> </span>
<span class="py-lineno"> 691</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">gaussian</span><span class="py-op">.</span><span class="py-name">lats</span><span class="py-op">(</span><span class="py-name">nlats</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 692</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">lat1</span> <span class="py-op">&lt;</span> <span class="py-name">lat2</span><span class="py-op">:</span>  <span class="py-comment"># reverse them if necessary</span> </span>
<span class="py-lineno"> 693</span>  <span class="py-line">                <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">lats</span><span class="py-op">[</span><span class="py-op">:</span><span class="py-op">:</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 694</span>  <span class="py-line">            <span class="py-name">lons</span><span class="py-op">,</span><span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">_meshgrid</span><span class="py-op">(</span><span class="py-name">lons</span><span class="py-op">,</span><span class="py-name">lats</span><span class="py-op">)</span> <span class="py-comment"># make 2-d arrays</span> </span>
<span class="py-lineno"> 695</span>  <span class="py-line">        <span class="py-comment"># mercator, lambert conformal, stereographic, albers equal area, azimuthal equidistant</span> </span>
<span class="py-lineno"> 696</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-number">20</span><span class="py-op">,</span><span class="py-number">30</span><span class="py-op">,</span><span class="py-number">31</span><span class="py-op">,</span><span class="py-number">110</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 697</span>  <span class="py-line">            <span class="py-name">nx</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_x_direction</span> </span>
<span class="py-lineno"> 698</span>  <span class="py-line">            <span class="py-name">ny</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> </span>
<span class="py-lineno"> 699</span>  <span class="py-line">            <span class="py-name">dx</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 700</span>  <span class="py-line">            <span class="py-name">dy</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> </span>
<span class="py-lineno"> 701</span>  <span class="py-line">            <span class="py-name">lon1</span><span class="py-op">,</span> <span class="py-name">lat1</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_first_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_first_gridpoint</span> </span>
<span class="py-lineno"> 702</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">10</span><span class="py-op">:</span> <span class="py-comment"># mercator.</span> </span>
<span class="py-lineno"> 703</span>  <span class="py-line">                <span class="py-name">lon2</span><span class="py-op">,</span> <span class="py-name">lat2</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">longitude_last_gridpoint</span><span class="py-op">,</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">latitude_last_gridpoint</span> </span>
<span class="py-lineno"> 704</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_ts'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_ts</span> </span>
<span class="py-lineno"> 705</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'proj'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> </span>
<span class="py-lineno"> 706</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lon_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> </span>
<span class="py-lineno"> 707</span>  <span class="py-line">                <span class="py-name">pj</span> <span class="py-op">=</span> <span class="py-name">Proj</span><span class="py-op">(</span><span class="py-name">projparams</span><span class="py-op">,</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lat1</span><span class="py-op">,</span><span class="py-name">lon2</span><span class="py-op">,</span><span class="py-name">lat2</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 708</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">20</span><span class="py-op">:</span>  <span class="py-comment"># stereographic</span> </span>
<span class="py-lineno"> 709</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_ts'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_ts</span> </span>
<span class="py-lineno"> 710</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'proj'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> </span>
<span class="py-lineno"> 711</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> </span>
<span class="py-lineno"> 712</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lon_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> </span>
<span class="py-lineno"> 713</span>  <span class="py-line">                <span class="py-name">pj</span> <span class="py-op">=</span> <span class="py-name">Proj</span><span class="py-op">(</span><span class="py-name">projparams</span><span class="py-op">,</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lat1</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dx</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dy</span><span class="py-op">,</span><span class="py-name">urcrnrislatlon</span><span class="py-op">=</span><span class="py-name">False</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 714</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">30</span><span class="py-op">,</span><span class="py-number">31</span><span class="py-op">]</span><span class="py-op">:</span> <span class="py-comment"># lambert, albers</span> </span>
<span class="py-lineno"> 715</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_1'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_1</span> </span>
<span class="py-lineno"> 716</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_2'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_2</span> </span>
<span class="py-lineno"> 717</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'proj'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> </span>
<span class="py-lineno"> 718</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lon_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> </span>
<span class="py-lineno"> 719</span>  <span class="py-line">                <span class="py-name">pj</span> <span class="py-op">=</span> <span class="py-name">Proj</span><span class="py-op">(</span><span class="py-name">projparams</span><span class="py-op">,</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lat1</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dx</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dy</span><span class="py-op">,</span><span class="py-name">urcrnrislatlon</span><span class="py-op">=</span><span class="py-name">False</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 720</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">110</span><span class="py-op">:</span> <span class="py-comment"># azimuthal equidistant</span> </span>
<span class="py-lineno"> 721</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'proj'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> </span>
<span class="py-lineno"> 722</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> </span>
<span class="py-lineno"> 723</span>  <span class="py-line">                <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lon_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> </span>
<span class="py-lineno"> 724</span>  <span class="py-line">                <span class="py-name">pj</span> <span class="py-op">=</span> <span class="py-name">Proj</span><span class="py-op">(</span><span class="py-name">projparams</span><span class="py-op">,</span><span class="py-name">lon1</span><span class="py-op">,</span><span class="py-name">lat1</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dx</span><span class="py-op">,</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">dy</span><span class="py-op">,</span><span class="py-name">urcrnrislatlon</span><span class="py-op">=</span><span class="py-name">False</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 725</span>  <span class="py-line">            <span class="py-name">lons</span><span class="py-op">,</span> <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">pj</span><span class="py-op">.</span><span class="py-name">makegrid</span><span class="py-op">(</span><span class="py-name">nx</span><span class="py-op">,</span><span class="py-name">ny</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 726</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">gdtnum</span> <span class="py-op">==</span> <span class="py-number">90</span><span class="py-op">:</span> <span class="py-comment"># satellite projection.</span> </span>
<span class="py-lineno"> 727</span>  <span class="py-line">            <span class="py-name">nx</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_x_direction</span> </span>
<span class="py-lineno"> 728</span>  <span class="py-line">            <span class="py-name">ny</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">points_in_y_direction</span> </span>
<span class="py-lineno"> 729</span>  <span class="py-line">            <span class="py-name">dx</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_x_direction</span> </span>
<span class="py-lineno"> 730</span>  <span class="py-line">            <span class="py-name">dy</span> <span class="py-op">=</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">gridlength_in_y_direction</span> </span>
<span class="py-lineno"> 731</span>  <span class="py-line">            <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'proj'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_proj</span> </span>
<span class="py-lineno"> 732</span>  <span class="py-line">            <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lon_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lon_0</span> </span>
<span class="py-lineno"> 733</span>  <span class="py-line">            <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'lat_0'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_lat_0</span> </span>
<span class="py-lineno"> 734</span>  <span class="py-line">            <span class="py-name">projparams</span><span class="py-op">[</span><span class="py-string">'h'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">proj4_h</span> </span>
<span class="py-lineno"> 735</span>  <span class="py-line">            <span class="py-name">pj</span> <span class="py-op">=</span> <span class="py-name">pyproj</span><span class="py-op">.</span><span class="py-name">Proj</span><span class="py-op">(</span><span class="py-name">projparams</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 736</span>  <span class="py-line">            <span class="py-name">x</span> <span class="py-op">=</span> <span class="py-name">dx</span><span class="py-op">*</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">indices</span><span class="py-op">(</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">,</span><span class="py-name">nx</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 737</span>  <span class="py-line">            <span class="py-name">x</span> <span class="py-op">=</span> <span class="py-name">x</span> <span class="py-op">-</span> <span class="py-number">0.5</span><span class="py-op">*</span><span class="py-name">x</span><span class="py-op">.</span><span class="py-name">max</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 738</span>  <span class="py-line">            <span class="py-name">y</span> <span class="py-op">=</span> <span class="py-name">dy</span><span class="py-op">*</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">indices</span><span class="py-op">(</span><span class="py-op">(</span><span class="py-name">ny</span><span class="py-op">,</span><span class="py-name">nx</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">,</span><span class="py-op">:</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 739</span>  <span class="py-line">            <span class="py-name">y</span> <span class="py-op">=</span> <span class="py-name">y</span> <span class="py-op">-</span> <span class="py-number">0.5</span><span class="py-op">*</span><span class="py-name">y</span><span class="py-op">.</span><span class="py-name">max</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 740</span>  <span class="py-line">            <span class="py-name">lons</span><span class="py-op">,</span> <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">pj</span><span class="py-op">(</span><span class="py-name">x</span><span class="py-op">,</span><span class="py-name">y</span><span class="py-op">,</span><span class="py-name">inverse</span><span class="py-op">=</span><span class="py-name">True</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 741</span>  <span class="py-line">            <span class="py-comment"># set lons,lats to 1.e30 where undefined</span> </span>
<span class="py-lineno"> 742</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-name">abslons</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">fabs</span><span class="py-op">(</span><span class="py-name">lons</span><span class="py-op">)</span><span class="py-op">;</span> <span class="py-name">abslats</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">fabs</span><span class="py-op">(</span><span class="py-name">lats</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 743</span>  <span class="py-line">            <span class="py-name">lons</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">where</span><span class="py-op">(</span><span class="py-name">abslons</span> <span class="py-op">&lt;</span> <span class="py-number">1.e20</span><span class="py-op">,</span> <span class="py-name">lons</span><span class="py-op">,</span> <span class="py-number">1.e30</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 744</span>  <span class="py-line">            <span class="py-name">lats</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">where</span><span class="py-op">(</span><span class="py-name">abslats</span> <span class="py-op">&lt;</span> <span class="py-number">1.e20</span><span class="py-op">,</span> <span class="py-name">lats</span><span class="py-op">,</span> <span class="py-number">1.e30</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 745</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 746</span>  <span class="py-line">            <span class="py-keyword">print</span> <span class="py-string">'%s not supported'</span> <span class="py-op">%</span> <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">type_of_grid</span> </span>
<span class="py-lineno"> 747</span>  <span class="py-line">            <span class="py-keyword">return</span> <span class="py-name">None</span><span class="py-op">,</span> <span class="py-name">None</span> </span>
<span class="py-lineno"> 748</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">lats</span><span class="py-op">.</span><span class="py-name">astype</span><span class="py-op">(</span><span class="py-string">'f'</span><span class="py-op">)</span><span class="py-op">,</span> <span class="py-name">lons</span><span class="py-op">.</span><span class="py-name">astype</span><span class="py-op">(</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
</div></div><span class="py-lineno"> 749</span>  <span class="py-line"> </span>
<a name="Grib2Decode"></a><div id="Grib2Decode-def"><span class="py-lineno"> 750</span> <a class="py-toggle" href="#" id="Grib2Decode-toggle" onclick="toggle('Grib2Decode'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#Grib2Decode">Grib2Decode</a><span class="py-op">(</span><span class="py-param">filename</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Decode-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="Grib2Decode-expanded"><span class="py-lineno"> 751</span>  <span class="py-line">    <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 752</span>  <span class="py-line"><span class="py-docstring"> Read the contents of a GRIB2 file.</span> </span>
<span class="py-lineno"> 753</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 754</span>  <span class="py-line"><span class="py-docstring"> @param filename: name of GRIB2 file.</span> </span>
<span class="py-lineno"> 755</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno"> 756</span>  <span class="py-line"><span class="py-docstring"> @return:  a list of L{Grib2Message} instances representing all of the</span> </span>
<span class="py-lineno"> 757</span>  <span class="py-line"><span class="py-docstring"> grib messages in the file.  Messages with multiple fields are split </span> </span>
<span class="py-lineno"> 758</span>  <span class="py-line"><span class="py-docstring"> into separate messages (so that each L{Grib2Message} instance contains</span> </span>
<span class="py-lineno"> 759</span>  <span class="py-line"><span class="py-docstring"> just one data field). The metadata in each GRIB2 message can be</span> </span>
<span class="py-lineno"> 760</span>  <span class="py-line"><span class="py-docstring"> accessed via L{Grib2Message} instance variables, the actual data </span> </span>
<span class="py-lineno"> 761</span>  <span class="py-line"><span class="py-docstring"> can be read using L{Grib2Message.data}, and the lat/lon values of the grid</span> </span>
<span class="py-lineno"> 762</span>  <span class="py-line"><span class="py-docstring"> can be accesses using L{Grib2Message.grid}.</span> </span>
<span class="py-lineno"> 763</span>  <span class="py-line"><span class="py-docstring">    """</span> </span>
<span class="py-lineno"> 764</span>  <span class="py-line">    <span class="py-name">f</span> <span class="py-op">=</span> <span class="py-name">open</span><span class="py-op">(</span><span class="py-name">filename</span><span class="py-op">,</span><span class="py-string">'rb'</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 765</span>  <span class="py-line">    <span class="py-name">nmsg</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 766</span>  <span class="py-line">    <span class="py-comment"># loop over grib messages, read section 0, get entire grib message.</span> </span>
<span class="py-lineno"> 767</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-name">disciplines</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 768</span>  <span class="py-line">    <span class="py-name">startingpos</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 769</span>  <span class="py-line">    <span class="py-name">msglen</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 770</span>  <span class="py-line">    <span class="py-keyword">while</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 771</span>  <span class="py-line">        <span class="py-comment"># find next occurence of string 'GRIB' (or EOF).</span> </span>
<span class="py-lineno"> 772</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">nbyte</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">tell</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 773</span>  <span class="py-line">        <span class="py-keyword">while</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 774</span>  <span class="py-line">            <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">nbyte</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 775</span>  <span class="py-line">            <span class="py-name">start</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-number">4</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 776</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">start</span> <span class="py-op">==</span> <span class="py-string">''</span> <span class="py-keyword">or</span> <span class="py-name">start</span> <span class="py-op">==</span> <span class="py-string">'GRIB'</span><span class="py-op">:</span> <span class="py-keyword">break</span> </span>
<span class="py-lineno"> 777</span>  <span class="py-line">            <span class="py-name">nbyte</span> <span class="py-op">=</span> <span class="py-name">nbyte</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno"> 778</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">start</span> <span class="py-op">==</span> <span class="py-string">''</span><span class="py-op">:</span> <span class="py-keyword">break</span> <span class="py-comment"># at EOF</span> </span>
<span class="py-lineno"> 779</span>  <span class="py-line">        <span class="py-comment"># otherwise, start (='GRIB') contains indicator message (section 0)</span> </span>
<span class="py-lineno"> 780</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">startpos</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">tell</span><span class="py-op">(</span><span class="py-op">)</span><span class="py-op">-</span><span class="py-number">4</span> </span>
<span class="py-lineno"> 781</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-number">2</span><span class="py-op">,</span><span class="py-number">1</span><span class="py-op">)</span>  <span class="py-comment"># next two octets are reserved</span> </span>
<span class="py-lineno"> 782</span>  <span class="py-line">        <span class="py-comment"># get discipline info.</span> </span>
<span class="py-lineno"> 783</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">disciplines</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 784</span>  <span class="py-line">        <span class="py-comment"># check to see it's a grib edition 2 file.</span> </span>
<span class="py-lineno"> 785</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">vers</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 786</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">vers</span> <span class="py-op">!=</span> <span class="py-number">2</span><span class="py-op">:</span>  </span>
<span class="py-lineno"> 787</span>  <span class="py-line">            <span class="py-keyword">raise</span> <span class="py-name">IOError</span><span class="py-op">,</span> <span class="py-string">'not a GRIB2 file (version number %d)'</span> <span class="py-op">%</span> <span class="py-name">vers</span> </span>
<span class="py-lineno"> 788</span>  <span class="py-line">        <span class="py-name">lengrib</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;q'</span><span class="py-op">,</span><span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-number">8</span><span class="py-op">)</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 789</span>  <span class="py-line">        <span class="py-name">msglen</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">lengrib</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 790</span>  <span class="py-line">        <span class="py-name">startingpos</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">startpos</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 791</span>  <span class="py-line">        <span class="py-comment"># read in entire grib message.</span> </span>
<span class="py-lineno"> 792</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">startpos</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 793</span>  <span class="py-line">        <span class="py-name">gribmsg</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-name">lengrib</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 794</span>  <span class="py-line">        <span class="py-comment"># make sure the message ends with '7777'</span> </span>
<span class="py-lineno"> 795</span>  <span class="py-line"><span class="py-comment"></span>        <span id="link-2" class="py-name"><a title="grib2.grib2.Grib2Encode.end" class="py-name" href="#" onclick="doclink('link-2', 'end', 'Method grib2.grib2.Grib2Encode.end()=grib2.grib2.Grib2Encode-class.html#end'); return false;">end</a></span></span> <span class="py-op">=</span> <span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-op">-</span><span class="py-number">4</span><span class="py-op">:</span><span class="py-name">lengrib</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 796</span>  <span class="py-line">        <span class="py-keyword">if</span> <span id="link-3" class="py-name"><a title="grib2.grib2.Grib2Encode.end" class="py-name" href="#" onclick="doclink('link-3', 'end', 'Method grib2.grib2.Grib2Encode.end()=grib2.grib2.Grib2Encode-class.html#end'); return false;">end</a></span></span> <span class="py-op">!=</span> <span class="py-string">'7777'</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 797</span>  <span class="py-line">           <span class="py-keyword">raise</span> <span class="py-name">IOError</span><span class="py-op">,</span> <span class="py-string">'partial GRIB message (no "7777" at end)'</span> </span>
<span class="py-lineno"> 798</span>  <span class="py-line">        <span class="py-comment"># do next message.</span> </span>
<span class="py-lineno"> 799</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">nmsg</span><span class="py-op">=</span><span class="py-name">nmsg</span><span class="py-op">+</span><span class="py-number">1</span> </span>
<span class="py-lineno"> 800</span>  <span class="py-line">    <span class="py-comment"># if no grib messages found, nmsg is still 0 and it's not GRIB.</span> </span>
<span class="py-lineno"> 801</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-keyword">if</span> <span class="py-name">nmsg</span><span class="py-op">==</span><span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 802</span>  <span class="py-line">       <span class="py-keyword">raise</span> <span class="py-name">IOError</span><span class="py-op">,</span> <span class="py-string">'not a GRIB file'</span> </span>
<span class="py-lineno"> 803</span>  <span class="py-line">    <span class="py-comment"># now for each grib message, find number of fields.</span> </span>
<span class="py-lineno"> 804</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-name">numfields</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 805</span>  <span class="py-line">    <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-number">0</span><span class="py-op">)</span> <span class="py-comment"># rewind file.</span> </span>
<span class="py-lineno"> 806</span>  <span class="py-line">    <span class="py-keyword">for</span> <span class="py-name">n</span> <span class="py-keyword">in</span> <span class="py-name">range</span><span class="py-op">(</span><span class="py-name">nmsg</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 807</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">startingpos</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 808</span>  <span class="py-line">        <span class="py-name">gribmsg</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-name">msglen</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 809</span>  <span class="py-line">        <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 810</span>  <span class="py-line">        <span class="py-name">numflds</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 811</span>  <span class="py-line">        <span class="py-keyword">while</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 812</span>  <span class="py-line">            <span class="py-keyword">if</span> <span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-string">'GRIB'</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 813</span>  <span class="py-line">                <span class="py-name">sectnum</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 814</span>  <span class="py-line">                <span class="py-name">lensect</span> <span class="py-op">=</span> <span class="py-number">16</span> </span>
<span class="py-lineno"> 815</span>  <span class="py-line">            <span class="py-keyword">elif</span> <span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-string">'7777'</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 816</span>  <span class="py-line">                <span class="py-keyword">break</span> </span>
<span class="py-lineno"> 817</span>  <span class="py-line">            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 818</span>  <span class="py-line">                <span class="py-name">lensect</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;i'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 819</span>  <span class="py-line">                <span class="py-name">sectnum</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 820</span>  <span class="py-line">                <span class="py-keyword">if</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">4</span><span class="py-op">:</span> <span class="py-name">numflds</span><span class="py-op">=</span><span class="py-name">numflds</span><span class="py-op">+</span><span class="py-number">1</span> </span>
<span class="py-lineno"> 821</span>  <span class="py-line">                <span class="py-comment">#if sectnum == 2: numlocal=numlocal+1</span> </span>
<span class="py-lineno"> 822</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-name">lensect</span> </span>
<span class="py-lineno"> 823</span>  <span class="py-line">            <span class="py-comment">#print sectnum,lensect,pos</span> </span>
<span class="py-lineno"> 824</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment">#print n+1,len(gribmsg),numfields,numlocal</span> </span>
<span class="py-lineno"> 825</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">numfields</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">numflds</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 826</span>  <span class="py-line">    <span class="py-comment"># decode each section in grib message (sections 1 and above).</span> </span>
<span class="py-lineno"> 827</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-name">gdtnum</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># grid defn template number from sxn 3</span> </span>
<span class="py-lineno"> 828</span>  <span class="py-line">    <span class="py-name">gdtmpl</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># grid defn template from sxn 3</span> </span>
<span class="py-lineno"> 829</span>  <span class="py-line">    <span class="py-name">gdeflist</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># optional grid definition list from sxn 3</span> </span>
<span class="py-lineno"> 830</span>  <span class="py-line">    <span class="py-name">gdsinfo</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># grid definition section info from sxn3</span> </span>
<span class="py-lineno"> 831</span>  <span class="py-line">    <span class="py-name">pdtmpl</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># product defn template from sxn 4</span> </span>
<span class="py-lineno"> 832</span>  <span class="py-line">    <span class="py-name">pdtnum</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># product defn template number from sxn 4</span> </span>
<span class="py-lineno"> 833</span>  <span class="py-line">    <span class="py-name">coordlist</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># vertical coordinate info from sxn 4</span> </span>
<span class="py-lineno"> 834</span>  <span class="py-line">    <span class="py-name">drtmpl</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># data representation template from sxn 5</span> </span>
<span class="py-lineno"> 835</span>  <span class="py-line">    <span class="py-name">drtnum</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># data representation template number from sxn 5</span> </span>
<span class="py-lineno"> 836</span>  <span class="py-line">    <span class="py-name">ndpts</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># number of data points to be unpacked (from sxn 5)</span> </span>
<span class="py-lineno"> 837</span>  <span class="py-line">    <span class="py-name">bitmapflag</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># bit-map indicator flag from sxn 6</span> </span>
<span class="py-lineno"> 838</span>  <span class="py-line">    <span class="py-name">bitmap</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># bitmap from sxn 6.</span> </span>
<span class="py-lineno"> 839</span>  <span class="py-line">    <span class="py-name">pos7</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># byte offset for section 7.</span> </span>
<span class="py-lineno"> 840</span>  <span class="py-line">    <span class="py-name">msgstart</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># byte offset in file for message start.</span> </span>
<span class="py-lineno"> 841</span>  <span class="py-line">    <span class="py-name">msglength</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># length of the message in bytes.</span> </span>
<span class="py-lineno"> 842</span>  <span class="py-line">    <span class="py-name">message</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># the actual grib message.</span> </span>
<span class="py-lineno"> 843</span>  <span class="py-line">    <span class="py-name">identsect</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># identification section (section 1).</span> </span>
<span class="py-lineno"> 844</span>  <span class="py-line">    <span class="py-name">discipline</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> <span class="py-comment"># discipline code.</span> </span>
<span class="py-lineno"> 845</span>  <span class="py-line">    <span class="py-keyword">for</span> <span class="py-name">n</span> <span class="py-keyword">in</span> <span class="py-name">range</span><span class="py-op">(</span><span class="py-name">nmsg</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 846</span>  <span class="py-line">        <span class="py-name">spos</span> <span class="py-op">=</span> <span class="py-name">startingpos</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 847</span>  <span class="py-line">        <span class="py-name">lengrib</span> <span class="py-op">=</span> <span class="py-name">msglen</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 848</span>  <span class="py-line">        <span class="py-comment">#gribmsg = gribmsgs[n]</span> </span>
<span class="py-lineno"> 849</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">spos</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 850</span>  <span class="py-line">        <span class="py-name">gribmsg</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-name">lengrib</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 851</span>  <span class="py-line">        <span class="py-name">discipl</span> <span class="py-op">=</span> <span class="py-name">disciplines</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 852</span>  <span class="py-line">        <span class="py-name">lensect0</span> <span class="py-op">=</span> <span class="py-number">16</span> </span>
<span class="py-lineno"> 853</span>  <span class="py-line">        <span class="py-comment"># get length of section 1 and section number.</span> </span>
<span class="py-lineno"> 854</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment">#lensect1 = struct.unpack('&gt;i',gribmsg[lensect0:lensect0+4])[0]</span> </span>
<span class="py-lineno"> 855</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment">#sectnum1 = struct.unpack('&gt;B',gribmsg[lensect0+4])[0]</span> </span>
<span class="py-lineno"> 856</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment">#print 'sectnum1, lensect1 = ',sectnum1,lensect1</span> </span>
<span class="py-lineno"> 857</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment"># unpack section 1, octets 1-21 (13 parameters).  This section</span> </span>
<span class="py-lineno"> 858</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment"># can occur only once per grib message.</span> </span>
<span class="py-lineno"> 859</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-comment">#idsect,pos = _unpack1(gribmsg,lensect0) # python version</span> </span>
<span class="py-lineno"> 860</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">idsect</span><span class="py-op">,</span><span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack1</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">lensect0</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> <span class="py-comment"># c version</span> </span>
<span class="py-lineno"> 861</span>  <span class="py-line">        <span class="py-comment"># loop over rest of sections in message.</span> </span>
<span class="py-lineno"> 862</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">gdtnums</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 863</span>  <span class="py-line">        <span class="py-name">gdtmpls</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 864</span>  <span class="py-line">        <span class="py-name">gdeflists</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 865</span>  <span class="py-line">        <span class="py-name">gdsinfos</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 866</span>  <span class="py-line">        <span class="py-name">pdtmpls</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 867</span>  <span class="py-line">        <span class="py-name">coordlists</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 868</span>  <span class="py-line">        <span class="py-name">pdtnums</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 869</span>  <span class="py-line">        <span class="py-name">drtmpls</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 870</span>  <span class="py-line">        <span class="py-name">drtnums</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 871</span>  <span class="py-line">        <span class="py-name">ndptslist</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 872</span>  <span class="py-line">        <span class="py-name">bitmapflags</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 873</span>  <span class="py-line">        <span class="py-name">bitmaps</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 874</span>  <span class="py-line">        <span class="py-name">sxn7pos</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 875</span>  <span class="py-line">        <span class="py-keyword">while</span> <span class="py-number">1</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 876</span>  <span class="py-line">            <span class="py-comment"># check to see if this is the end of the message.</span> </span>
<span class="py-lineno"> 877</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">if</span> <span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span> <span class="py-op">==</span> <span class="py-string">'7777'</span><span class="py-op">:</span> <span class="py-keyword">break</span> </span>
<span class="py-lineno"> 878</span>  <span class="py-line">            <span class="py-name">lensect</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;i'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 879</span>  <span class="py-line">            <span class="py-name">sectnum</span> <span class="py-op">=</span> <span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 880</span>  <span class="py-line">            <span class="py-comment"># section 2, local use section.</span> </span>
<span class="py-lineno"> 881</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">if</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">2</span><span class="py-op">:</span>  <span class="py-comment"># skip</span> </span>
<span class="py-lineno"> 882</span>  <span class="py-line">                <span class="py-comment">#localsxns.append(gribmsg[pos+5:pos+lensect-5])</span> </span>
<span class="py-lineno"> 883</span>  <span class="py-line"><span class="py-comment"></span>                <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-name">lensect</span> </span>
<span class="py-lineno"> 884</span>  <span class="py-line">            <span class="py-comment"># section 3, grid definition section.</span> </span>
<span class="py-lineno"> 885</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">elif</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">3</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 886</span>  <span class="py-line">                <span class="py-name">gds</span><span class="py-op">,</span><span class="py-name">gdtempl</span><span class="py-op">,</span><span class="py-name">deflist</span><span class="py-op">,</span><span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack3</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">pos</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 887</span>  <span class="py-line">                <span class="py-name">gdtnums</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">gds</span><span class="py-op">[</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 888</span>  <span class="py-line">                <span class="py-name">gdtmpls</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">gdtempl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 889</span>  <span class="py-line">                <span class="py-name">gdeflists</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">deflist</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 890</span>  <span class="py-line">                <span class="py-name">gdsinfos</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">gds</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 891</span>  <span class="py-line">            <span class="py-comment"># section, product definition section.</span> </span>
<span class="py-lineno"> 892</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">elif</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">4</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 893</span>  <span class="py-line">                <span class="py-name">pdtempl</span><span class="py-op">,</span><span class="py-name">pdtn</span><span class="py-op">,</span><span class="py-name">coordlst</span><span class="py-op">,</span><span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack4</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">pos</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 894</span>  <span class="py-line">                <span class="py-name">pdtmpls</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">pdtempl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 895</span>  <span class="py-line">                <span class="py-name">coordlists</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">coordlst</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 896</span>  <span class="py-line">                <span class="py-name">pdtnums</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">pdtn</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 897</span>  <span class="py-line">            <span class="py-comment"># section 5, data representation section.</span> </span>
<span class="py-lineno"> 898</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">elif</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">5</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 899</span>  <span class="py-line">                <span class="py-name">drtempl</span><span class="py-op">,</span><span class="py-name">drtn</span><span class="py-op">,</span><span class="py-name">npts</span><span class="py-op">,</span><span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack5</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">pos</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 900</span>  <span class="py-line">                <span class="py-name">drtmpls</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">drtempl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 901</span>  <span class="py-line">                <span class="py-name">drtnums</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">drtn</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 902</span>  <span class="py-line">                <span class="py-name">ndptslist</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">npts</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 903</span>  <span class="py-line">            <span class="py-comment"># section 6, bit-map section.</span> </span>
<span class="py-lineno"> 904</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">elif</span> <span class="py-name">sectnum</span> <span class="py-op">==</span> <span class="py-number">6</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 905</span>  <span class="py-line">                <span class="py-name">bmap</span><span class="py-op">,</span><span class="py-name">bmapflag</span> <span class="py-op">=</span> <span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">unpack6</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">,</span><span class="py-name">gds</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">pos</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">zeros</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 906</span>  <span class="py-line">                <span class="py-comment">#bitmapflag = struct.unpack('&gt;B',gribmsg[pos+5])[0]</span> </span>
<span class="py-lineno"> 907</span>  <span class="py-line"><span class="py-comment"></span>                <span class="py-keyword">if</span> <span class="py-name">bmapflag</span> <span class="py-op">==</span> <span class="py-number">0</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 908</span>  <span class="py-line">                    <span class="py-name">bitmaps</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">bmap</span><span class="py-op">.</span><span class="py-name">astype</span><span class="py-op">(</span><span class="py-string">'b'</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 909</span>  <span class="py-line">                <span class="py-comment"># use last defined bitmap.</span> </span>
<span class="py-lineno"> 910</span>  <span class="py-line"><span class="py-comment"></span>                <span class="py-keyword">elif</span> <span class="py-name">bmapflag</span> <span class="py-op">==</span> <span class="py-number">254</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 911</span>  <span class="py-line">                    <span class="py-name">bmapflag</span> <span class="py-op">=</span> <span class="py-number">0</span> </span>
<span class="py-lineno"> 912</span>  <span class="py-line">                    <span class="py-keyword">for</span> <span class="py-name">bmp</span> <span class="py-keyword">in</span> <span class="py-name">bitmaps</span><span class="py-op">[</span><span class="py-op">:</span><span class="py-op">:</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 913</span>  <span class="py-line">                        <span class="py-keyword">if</span> <span class="py-name">bmp</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> <span class="py-name">bitmaps</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">bmp</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 914</span>  <span class="py-line">                <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 915</span>  <span class="py-line">                    <span class="py-name">bitmaps</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">None</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 916</span>  <span class="py-line">                <span class="py-name">bitmapflags</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">bmapflag</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 917</span>  <span class="py-line">                <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-name">lensect</span> </span>
<span class="py-lineno"> 918</span>  <span class="py-line">            <span class="py-comment"># section 7, data section (nothing done here,</span> </span>
<span class="py-lineno"> 919</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-comment"># data unpacked when getfld method is invoked).</span> </span>
<span class="py-lineno"> 920</span>  <span class="py-line"><span class="py-comment"></span>            <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 921</span>  <span class="py-line">                <span class="py-keyword">if</span> <span class="py-name">sectnum</span> <span class="py-op">!=</span> <span class="py-number">7</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 922</span>  <span class="py-line">                   <span class="py-name">msg</span> <span class="py-op">=</span> <span class="py-string">'unknown section = %i'</span> <span class="py-op">%</span> <span class="py-name">sectnum</span> </span>
<span class="py-lineno"> 923</span>  <span class="py-line">                   <span class="py-keyword">raise</span> <span class="py-name">ValueError</span><span class="py-op">,</span><span class="py-name">msg</span> </span>
<span class="py-lineno"> 924</span>  <span class="py-line">                <span class="py-name">sxn7pos</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">pos</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 925</span>  <span class="py-line">                <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-name">lensect</span> </span>
<span class="py-lineno"> 926</span>  <span class="py-line">        <span class="py-comment"># extend by repeating last value for all remaining fields.</span> </span>
<span class="py-lineno"> 927</span>  <span class="py-line"><span class="py-comment"></span>        <span class="py-name">gdtnum</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdtnums</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 928</span>  <span class="py-line">        <span class="py-name">gdtmpl</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdtmpls</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 929</span>  <span class="py-line">        <span class="py-name">gdeflist</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdeflists</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 930</span>  <span class="py-line">        <span class="py-name">gdsinfo</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">gdsinfos</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 931</span>  <span class="py-line">        <span class="py-name">pdtmpl</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">pdtmpls</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 932</span>  <span class="py-line">        <span class="py-name">pdtnum</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">pdtnums</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 933</span>  <span class="py-line">        <span class="py-name">coordlist</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">coordlists</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 934</span>  <span class="py-line">        <span class="py-name">drtmpl</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">drtmpls</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 935</span>  <span class="py-line">        <span class="py-name">drtnum</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">drtnums</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 936</span>  <span class="py-line">        <span class="py-name">ndpts</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">ndptslist</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 937</span>  <span class="py-line">        <span class="py-name">bitmapflag</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">bitmapflags</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 938</span>  <span class="py-line">        <span class="py-name">bitmap</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">bitmaps</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 939</span>  <span class="py-line">        <span class="py-name">pos7</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">sxn7pos</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 940</span>  <span class="py-line">        <span class="py-name">msgstart</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-op">[</span><span class="py-name">spos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 941</span>  <span class="py-line">        <span class="py-name">msglength</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-op">[</span><span class="py-name">lengrib</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 942</span>  <span class="py-line">        <span class="py-name">identsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-op">[</span><span class="py-name">idsect</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 943</span>  <span class="py-line">        <span class="py-name">discipline</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">_repeatlast</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-op">[</span><span class="py-name">discipl</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 944</span>  <span class="py-line"> </span>
<span class="py-lineno"> 945</span>  <span class="py-line">    <span class="py-name">gdtnum</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">gdtnum</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 946</span>  <span class="py-line">    <span class="py-name">gdtmpl</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">gdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 947</span>  <span class="py-line">    <span class="py-name">gdeflist</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">gdeflist</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 948</span>  <span class="py-line">    <span class="py-name">gdsinfo</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">gdsinfo</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 949</span>  <span class="py-line">    <span class="py-name">pdtmpl</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 950</span>  <span class="py-line">    <span class="py-name">pdtnum</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">pdtnum</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 951</span>  <span class="py-line">    <span class="py-name">coordlist</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">coordlist</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 952</span>  <span class="py-line">    <span class="py-name">drtmpl</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">drtmpl</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 953</span>  <span class="py-line">    <span class="py-name">drtnum</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">drtnum</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 954</span>  <span class="py-line">    <span class="py-name">ndpts</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">ndpts</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 955</span>  <span class="py-line">    <span class="py-name">bitmapflag</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">bitmapflag</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 956</span>  <span class="py-line">    <span class="py-name">bitmap</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">bitmap</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 957</span>  <span class="py-line">    <span class="py-name">pos7</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">pos7</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 958</span>  <span class="py-line">    <span class="py-name">msgstart</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">msgstart</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 959</span>  <span class="py-line">    <span class="py-name">msglength</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">msglength</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 960</span>  <span class="py-line">    <span class="py-name">identsect</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">identsect</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 961</span>  <span class="py-line">    <span class="py-name">discipline</span> <span class="py-op">=</span> <span class="py-name">_flatten</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">,</span><span class="py-name">discipline</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 962</span>  <span class="py-line"> </span>
<span class="py-lineno"> 963</span>  <span class="py-line">    <span class="py-name">gribs</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 964</span>  <span class="py-line">    <span class="py-keyword">for</span> <span class="py-name">n</span> <span class="py-keyword">in</span> <span class="py-name">range</span><span class="py-op">(</span><span class="py-name">len</span><span class="py-op">(</span><span class="py-name">msgstart</span><span class="py-op">)</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 965</span>  <span class="py-line">        <span class="py-name">kwargs</span> <span class="py-op">=</span> <span class="py-op">{</span><span class="py-op">}</span> </span>
<span class="py-lineno"> 966</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'grid_definition_template_number'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">gdtnum</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 967</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'grid_definition_template'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">gdtmpl</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 968</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">gdeflist</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-op">[</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 969</span>  <span class="py-line">            <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'grid_definition_list'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">gdeflist</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 970</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'grid_definition_info'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">gdsinfo</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 971</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'discipline_code'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">discipline</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 972</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'product_definition_template_number'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">pdtnum</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 973</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'product_definition_template'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 974</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'data_representation_template_number'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">drtnum</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 975</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'data_representation_template'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">drtmpl</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 976</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">coordlist</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-op">[</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 977</span>  <span class="py-line">            <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'extra_vertical_coordinate_info'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">coordlist</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 978</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'number_of_data_points_to_unpack'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">ndpts</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 979</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'bitmap_indicator_flag'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">bitmapflag</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 980</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">bitmap</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-op">[</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno"> 981</span>  <span class="py-line">            <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_bitmap'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">bitmap</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 982</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_section7_byte_offset'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">pos7</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 983</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_grib_message_byteoffset'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">msgstart</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 984</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_grib_message_length'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">msglength</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 985</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_grib_filename'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">filename</span> </span>
<span class="py-lineno"> 986</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'identification_section'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">identsect</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span> </span>
<span class="py-lineno"> 987</span>  <span class="py-line">        <span class="py-name">kwargs</span><span class="py-op">[</span><span class="py-string">'_grib_message_number'</span><span class="py-op">]</span><span class="py-op">=</span><span class="py-name">n</span><span class="py-op">+</span><span class="py-number">1</span> </span>
<span class="py-lineno"> 988</span>  <span class="py-line">        <span class="py-name">gribs</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span id="link-4" class="py-name"><a title="grib2.grib2.Grib2Message" class="py-name" href="#" onclick="doclink('link-4', 'Grib2Message', 'Class grib2.grib2.Grib2Message=grib2.grib2.Grib2Message-class.html'); return false;">Grib2Message</a></span></span><span class="py-op">(</span><span class="py-op">**</span><span class="py-name">kwargs</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 989</span>  <span class="py-line">    <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">close</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno"> 990</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">gribs</span>  </span>
</div><span class="py-lineno"> 991</span>  <span class="py-line"> </span>
<a name="dump"></a><div id="dump-def"><span class="py-lineno"> 992</span> <a class="py-toggle" href="#" id="dump-toggle" onclick="toggle('dump'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#dump">dump</a><span class="py-op">(</span><span class="py-param">filename</span><span class="py-op">,</span> <span class="py-param">grbs</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="dump-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="dump-expanded"><span class="py-lineno"> 993</span>  <span class="py-line">    <span class="py-docstring">"""</span> </span>
<span class="py-lineno"> 994</span>  <span class="py-line"><span class="py-docstring"> write the given L{Grib2Message} instances to a grib file.</span> </span>
<span class="py-lineno"> 995</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno"> 996</span>  <span class="py-line"><span class="py-docstring"> @param filename: file to write grib data to.</span> </span>
<span class="py-lineno"> 997</span>  <span class="py-line"><span class="py-docstring"> @param grbs: a list of L{Grib2Message} instances.</span> </span>
<span class="py-lineno"> 998</span>  <span class="py-line"><span class="py-docstring">    """</span> </span>
<span class="py-lineno"> 999</span>  <span class="py-line">    <span class="py-name">gribfile</span> <span class="py-op">=</span> <span class="py-name">open</span><span class="py-op">(</span><span class="py-name">filename</span><span class="py-op">,</span><span class="py-string">'wb'</span><span class="py-op">)</span> </span>
<span class="py-lineno">1000</span>  <span class="py-line">    <span class="py-keyword">for</span> <span class="py-name">grb</span> <span class="py-keyword">in</span> <span class="py-name">grbs</span><span class="py-op">:</span> </span>
<span class="py-lineno">1001</span>  <span class="py-line">        <span class="py-name">f</span> <span class="py-op">=</span> <span class="py-name">open</span><span class="py-op">(</span><span class="py-name">grb</span><span class="py-op">.</span><span class="py-name">_grib_filename</span><span class="py-op">,</span><span class="py-string">'rb'</span><span class="py-op">)</span> </span>
<span class="py-lineno">1002</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">seek</span><span class="py-op">(</span><span class="py-name">grb</span><span class="py-op">.</span><span class="py-name">_grib_message_byteoffset</span><span class="py-op">)</span> </span>
<span class="py-lineno">1003</span>  <span class="py-line">        <span class="py-name">gribmsg</span> <span class="py-op">=</span> <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">read</span><span class="py-op">(</span><span class="py-name">grb</span><span class="py-op">.</span><span class="py-name">_grib_message_length</span><span class="py-op">)</span> </span>
<span class="py-lineno">1004</span>  <span class="py-line">        <span class="py-name">f</span><span class="py-op">.</span><span class="py-name">close</span><span class="py-op">(</span><span class="py-op">)</span> </span>
<span class="py-lineno">1005</span>  <span class="py-line">        <span class="py-name">gribfile</span><span class="py-op">.</span><span class="py-name">write</span><span class="py-op">(</span><span class="py-name">gribmsg</span><span class="py-op">)</span> </span>
<span class="py-lineno">1006</span>  <span class="py-line">    <span class="py-name">gribfile</span><span class="py-op">.</span><span class="py-name">close</span><span class="py-op">(</span><span class="py-op">)</span>  </span>
</div><span class="py-lineno">1007</span>  <span class="py-line"> </span>
<span class="py-lineno">1008</span>  <span class="py-line"><span class="py-comment"># private methods and functions below here.</span> </span>
<span class="py-lineno">1009</span>  <span class="py-line"><span class="py-comment"></span> </span>
<a name="_getvertlevel"></a><div id="_getvertlevel-def"><span class="py-lineno">1010</span> <a class="py-toggle" href="#" id="_getvertlevel-toggle" onclick="toggle('_getvertlevel'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getvertlevel">_getvertlevel</a><span class="py-op">(</span><span class="py-param">pdtmpl</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getvertlevel-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getvertlevel-expanded"><span class="py-lineno">1011</span>  <span class="py-line">    <span class="py-docstring">"""return vertical coordinate level info"""</span> </span>
<span class="py-lineno">1012</span>  <span class="py-line">    <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">1013</span>  <span class="py-line">        <span class="py-name">level1info</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">5</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1014</span>  <span class="py-line">        <span class="py-name">scaledlevel1</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">11</span><span class="py-op">]</span> </span>
<span class="py-lineno">1015</span>  <span class="py-line">        <span class="py-name">level1scale</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span> </span>
<span class="py-lineno">1016</span>  <span class="py-line">    <span class="py-keyword">except</span><span class="py-op">:</span> </span>
<span class="py-lineno">1017</span>  <span class="py-line">        <span class="py-name">scaledlevel1</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1018</span>  <span class="py-line">        <span class="py-name">level1scale</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1019</span>  <span class="py-line">        <span class="py-name">level1info</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-string">''</span><span class="py-op">,</span><span class="py-string">''</span><span class="py-op">]</span> </span>
<span class="py-lineno">1020</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">level1scale</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-op">-</span><span class="py-number">127</span><span class="py-op">,</span><span class="py-number">255</span><span class="py-op">]</span><span class="py-op">:</span> <span class="py-comment"># either of these two values can indicate 'Missing'</span> </span>
<span class="py-lineno">1021</span>  <span class="py-line">        <span class="py-name">level1scale</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1022</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">scaledlevel1</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">2</span><span class="py-op">*</span><span class="py-op">(</span><span class="py-number">2</span><span class="py-op">**</span><span class="py-number">31</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-op">-</span><span class="py-op">(</span><span class="py-number">2</span><span class="py-op">**</span><span class="py-number">31</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">)</span><span class="py-op">]</span><span class="py-op">:</span> <span class="py-comment"># ditto </span> </span>
<span class="py-lineno">1023</span>  <span class="py-line">        <span class="py-name">scaledlevel1</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1024</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">scaledlevel1</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span> <span class="py-keyword">and</span> <span class="py-name">level1scale</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno">1025</span>  <span class="py-line">        <span class="py-name">level1</span> <span class="py-op">=</span> <span class="py-name">math</span><span class="py-op">.</span><span class="py-name">pow</span><span class="py-op">(</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-name">level1scale</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">scaledlevel1</span> </span>
<span class="py-lineno">1026</span>  <span class="py-line">    <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1027</span>  <span class="py-line">        <span class="py-name">level1</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1028</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">len</span><span class="py-op">(</span><span class="py-name">pdtmpl</span><span class="py-op">)</span> <span class="py-op">&gt;=</span> <span class="py-number">12</span> <span class="py-keyword">and</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span> <span class="py-op">!=</span> <span class="py-number">255</span><span class="py-op">:</span> </span>
<span class="py-lineno">1029</span>  <span class="py-line">       <span class="py-name">level2info</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">5</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1030</span>  <span class="py-line">       <span class="py-name">scaledlevel2</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">14</span><span class="py-op">]</span> </span>
<span class="py-lineno">1031</span>  <span class="py-line">       <span class="py-name">level2scale</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">13</span><span class="py-op">]</span> </span>
<span class="py-lineno">1032</span>  <span class="py-line">       <span class="py-name">level2</span> <span class="py-op">=</span> <span class="py-name">math</span><span class="py-op">.</span><span class="py-name">pow</span><span class="py-op">(</span><span class="py-number">10</span><span class="py-op">,</span><span class="py-name">level2scale</span><span class="py-op">)</span><span class="py-op">*</span><span class="py-name">scaledlevel2</span> </span>
<span class="py-lineno">1033</span>  <span class="py-line">       <span class="py-keyword">return</span> <span class="py-name">level1</span><span class="py-op">,</span><span class="py-name">level1info</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">level1info</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">level2</span><span class="py-op">,</span><span class="py-name">level2info</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">level2info</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno">1034</span>  <span class="py-line">    <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1035</span>  <span class="py-line">       <span class="py-keyword">return</span> <span class="py-name">level1</span><span class="py-op">,</span><span class="py-name">level1info</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-name">level1info</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
</div><span class="py-lineno">1036</span>  <span class="py-line"> </span>
<a name="_getdate"></a><div id="_getdate-def"><span class="py-lineno">1037</span> <a class="py-toggle" href="#" id="_getdate-toggle" onclick="toggle('_getdate'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getdate">_getdate</a><span class="py-op">(</span><span class="py-param">idsect</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getdate-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getdate-expanded"><span class="py-lineno">1038</span>  <span class="py-line">    <span class="py-docstring">"""return yyyy,mm,dd,min,ss from section 1"""</span> </span>
<span class="py-lineno">1039</span>  <span class="py-line">    <span class="py-name">yyyy</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">5</span><span class="py-op">]</span> </span>
<span class="py-lineno">1040</span>  <span class="py-line">    <span class="py-name">mm</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span> </span>
<span class="py-lineno">1041</span>  <span class="py-line">    <span class="py-name">dd</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">7</span><span class="py-op">]</span> </span>
<span class="py-lineno">1042</span>  <span class="py-line">    <span class="py-name">hh</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">8</span><span class="py-op">]</span> </span>
<span class="py-lineno">1043</span>  <span class="py-line">    <span class="py-name">min</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">9</span><span class="py-op">]</span> </span>
<span class="py-lineno">1044</span>  <span class="py-line">    <span class="py-name">ss</span><span class="py-op">=</span><span class="py-name">idsect</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span> </span>
<span class="py-lineno">1045</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">yyyy</span><span class="py-op">,</span><span class="py-name">mm</span><span class="py-op">,</span><span class="py-name">dd</span><span class="py-op">,</span><span class="py-name">hh</span><span class="py-op">,</span><span class="py-name">min</span><span class="py-op">,</span><span class="py-name">ss</span> </span>
</div><span class="py-lineno">1046</span>  <span class="py-line"> </span>
<a name="_getftime"></a><div id="_getftime-def"><span class="py-lineno">1047</span> <a class="py-toggle" href="#" id="_getftime-toggle" onclick="toggle('_getftime'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getftime">_getftime</a><span class="py-op">(</span><span class="py-param">pdtnum</span><span class="py-op">,</span><span class="py-param">pdtmpl</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getftime-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getftime-expanded"><span class="py-lineno">1048</span>  <span class="py-line">    <span class="py-docstring">"""return forecast time, units"""</span> </span>
<span class="py-lineno">1049</span>  <span class="py-line">    <span class="py-comment"># assumes forecast time is eighth value in </span> </span>
<span class="py-lineno">1050</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-comment"># all product defn templates.</span> </span>
<span class="py-lineno">1051</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-name">time</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">8</span><span class="py-op">]</span> </span>
<span class="py-lineno">1052</span>  <span class="py-line">    <span class="py-name">units</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">7</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1053</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">pdtnum</span> <span class="py-op">==</span> <span class="py-number">8</span><span class="py-op">:</span> </span>
<span class="py-lineno">1054</span>  <span class="py-line">        <span class="py-name">stattype</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">23</span><span class="py-op">]</span> </span>
<span class="py-lineno">1055</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">stattype</span> <span class="py-op">==</span> <span class="py-number">255</span><span class="py-op">:</span> </span>
<span class="py-lineno">1056</span>  <span class="py-line">            <span class="py-name">stattype</span> <span class="py-op">=</span> <span class="py-string">'Period'</span> </span>
<span class="py-lineno">1057</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1058</span>  <span class="py-line">            <span class="py-name">stattype</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">10</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">stattype</span><span class="py-op">]</span> </span>
<span class="py-lineno">1059</span>  <span class="py-line">        <span class="py-name">timeintervalunits</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">25</span><span class="py-op">]</span> </span>
<span class="py-lineno">1060</span>  <span class="py-line">        <span class="py-name">timeintervalunits</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">4</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">timeintervalunits</span><span class="py-op">]</span> </span>
<span class="py-lineno">1061</span>  <span class="py-line">        <span class="py-name">timeintervallen</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">26</span><span class="py-op">]</span> </span>
<span class="py-lineno">1062</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">timeintervalunits</span> <span class="py-op">==</span> <span class="py-number">10</span><span class="py-op">:</span> </span>
<span class="py-lineno">1063</span>  <span class="py-line">            <span class="py-name">timelintervallen</span> <span class="py-op">=</span> <span class="py-name">timeintervallen</span><span class="py-op">*</span><span class="py-number">3</span> </span>
<span class="py-lineno">1064</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">timeintervalunits</span> <span class="py-op">==</span> <span class="py-number">11</span><span class="py-op">:</span> </span>
<span class="py-lineno">1065</span>  <span class="py-line">            <span class="py-name">timeintervallen</span> <span class="py-op">=</span> <span class="py-name">timeintervallen</span><span class="py-op">*</span><span class="py-number">6</span> </span>
<span class="py-lineno">1066</span>  <span class="py-line">        <span class="py-keyword">elif</span> <span class="py-name">timeintervalunits</span> <span class="py-op">==</span> <span class="py-number">12</span><span class="py-op">:</span> </span>
<span class="py-lineno">1067</span>  <span class="py-line">            <span class="py-name">timeintervallen</span> <span class="py-op">=</span> <span class="py-name">timeintervallen</span><span class="py-op">*</span><span class="py-number">12</span> </span>
<span class="py-lineno">1068</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">time</span><span class="py-op">,</span><span class="py-name">units</span><span class="py-op">,</span><span class="py-name">timeintervallen</span><span class="py-op">,</span><span class="py-name">timeintervalunits</span><span class="py-op">,</span><span class="py-name">stattype</span> </span>
<span class="py-lineno">1069</span>  <span class="py-line">    <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1070</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">time</span><span class="py-op">,</span><span class="py-name">units</span> </span>
</div><span class="py-lineno">1071</span>  <span class="py-line"> </span>
<a name="_getensinfo"></a><div id="_getensinfo-def"><span class="py-lineno">1072</span> <a class="py-toggle" href="#" id="_getensinfo-toggle" onclick="toggle('_getensinfo'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getensinfo">_getensinfo</a><span class="py-op">(</span><span class="py-param">pdtnum</span><span class="py-op">,</span><span class="py-param">pdtmpl</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getensinfo-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getensinfo-expanded"><span class="py-lineno">1073</span>  <span class="py-line">    <span class="py-docstring">"""return ensemble info (from pdts 4.1, 4.2, 4.11, 4.12)"""</span> </span>
<span class="py-lineno">1074</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">pdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">1</span><span class="py-op">,</span><span class="py-number">11</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno">1075</span>  <span class="py-line">        <span class="py-name">enstype</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">6</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1076</span>  <span class="py-line">        <span class="py-name">pertnum</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span> </span>
<span class="py-lineno">1077</span>  <span class="py-line">        <span class="py-name">nmembers</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">17</span><span class="py-op">]</span> </span>
<span class="py-lineno">1078</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">enstype</span><span class="py-op">,</span><span class="py-name">pertnum</span><span class="py-op">,</span><span class="py-name">nmembers</span> </span>
<span class="py-lineno">1079</span>  <span class="py-line">    <span class="py-keyword">elif</span> <span class="py-name">pdtnum</span> <span class="py-keyword">in</span> <span class="py-op">[</span><span class="py-number">2</span><span class="py-op">,</span><span class="py-number">12</span><span class="py-op">]</span><span class="py-op">:</span> </span>
<span class="py-lineno">1080</span>  <span class="py-line">        <span class="py-name">enstype</span> <span class="py-op">=</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">7</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">15</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1081</span>  <span class="py-line">        <span class="py-name">nmembers</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">16</span><span class="py-op">]</span> </span>
<span class="py-lineno">1082</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">enstype</span><span class="py-op">,</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-name">nmembers</span> </span>
<span class="py-lineno">1083</span>  <span class="py-line">    <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1084</span>  <span class="py-line">        <span class="py-keyword">print</span> <span class="py-string">'not an ensemble product'</span> </span>
<span class="py-lineno">1085</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">None</span><span class="py-op">,</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-name">None</span> </span>
</div><span class="py-lineno">1086</span>  <span class="py-line"> </span>
<a name="_getdiscipline"></a><div id="_getdiscipline-def"><span class="py-lineno">1087</span> <a class="py-toggle" href="#" id="_getdiscipline-toggle" onclick="toggle('_getdiscipline'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getdiscipline">_getdiscipline</a><span class="py-op">(</span><span class="py-param">discipline</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getdiscipline-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getdiscipline-expanded"><span class="py-lineno">1088</span>  <span class="py-line">    <span class="py-docstring">"""return descipline"""</span> </span>
<span class="py-lineno">1089</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">sxn0</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-name">discipline</span><span class="py-op">]</span>  </span>
</div><span class="py-lineno">1090</span>  <span class="py-line"> </span>
<a name="_getpdt"></a><div id="_getpdt-def"><span class="py-lineno">1091</span> <a class="py-toggle" href="#" id="_getpdt-toggle" onclick="toggle('_getpdt'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getpdt">_getpdt</a><span class="py-op">(</span><span class="py-param">pdtnum</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getpdt-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getpdt-expanded"><span class="py-lineno">1092</span>  <span class="py-line">    <span class="py-docstring">"""return name of product definition template"""</span> </span>
<span class="py-lineno">1093</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtnum</span><span class="py-op">]</span> </span>
</div><span class="py-lineno">1094</span>  <span class="py-line"> </span>
<a name="_getparamcat"></a><div id="_getparamcat-def"><span class="py-lineno">1095</span> <a class="py-toggle" href="#" id="_getparamcat-toggle" onclick="toggle('_getparamcat'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getparamcat">_getparamcat</a><span class="py-op">(</span><span class="py-param">discipline</span><span class="py-op">,</span><span class="py-param">pdtmpl</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getparamcat-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getparamcat-expanded"><span class="py-lineno">1096</span>  <span class="py-line">    <span class="py-docstring">"""return parameter category description"""</span> </span>
<span class="py-lineno">1097</span>  <span class="py-line">    <span class="py-name">paramcat</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno">1098</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">discipline</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">paramcat</span><span class="py-op">]</span> </span>
</div><span class="py-lineno">1099</span>  <span class="py-line"> </span>
<a name="_getparam"></a><div id="_getparam-def"><span class="py-lineno">1100</span> <a class="py-toggle" href="#" id="_getparam-toggle" onclick="toggle('_getparam'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_getparam">_getparam</a><span class="py-op">(</span><span class="py-param">discipline</span><span class="py-op">,</span><span class="py-param">pdtmpl</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_getparam-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_getparam-expanded"><span class="py-lineno">1101</span>  <span class="py-line">    <span class="py-docstring">"""return parameter name, units"""</span> </span>
<span class="py-lineno">1102</span>  <span class="py-line">    <span class="py-comment"># assumes parameter category and parameter number are first two in </span> </span>
<span class="py-lineno">1103</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-comment"># all product defn templates.</span> </span>
<span class="py-lineno">1104</span>  <span class="py-line"><span class="py-comment"></span>    <span class="py-name">paramcat</span> <span class="py-op">=</span> <span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span> </span>
<span class="py-lineno">1105</span>  <span class="py-line">    <span class="py-keyword">try</span><span class="py-op">:</span> </span>
<span class="py-lineno">1106</span>  <span class="py-line">        <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">discipline</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">paramcat</span><span class="py-op">]</span><span class="py-op">.</span><span class="py-name">has_key</span><span class="py-op">(</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">)</span>  </span>
<span class="py-lineno">1107</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-name">sxn4</span><span class="py-op">.</span><span class="py-name">codetable</span><span class="py-op">[</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">discipline</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">paramcat</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">pdtmpl</span><span class="py-op">[</span><span class="py-number">1</span><span class="py-op">]</span><span class="py-op">]</span> </span>
<span class="py-lineno">1108</span>  <span class="py-line">    <span class="py-keyword">except</span><span class="py-op">:</span> </span>
<span class="py-lineno">1109</span>  <span class="py-line">        <span class="py-keyword">return</span> <span class="py-string">'Unknown'</span><span class="py-op">,</span><span class="py-string">''</span> </span>
</div><span class="py-lineno">1110</span>  <span class="py-line"> </span>
<a name="_unpack1"></a><div id="_unpack1-def"><span class="py-lineno">1111</span> <a class="py-toggle" href="#" id="_unpack1-toggle" onclick="toggle('_unpack1'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_unpack1">_unpack1</a><span class="py-op">(</span><span class="py-param">gribmsg</span><span class="py-op">,</span><span class="py-param">pos</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_unpack1-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_unpack1-expanded"><span class="py-lineno">1112</span>  <span class="py-line">    <span class="py-docstring">"""unpack section 1 given starting point in bytes</span> </span>
<span class="py-lineno">1113</span>  <span class="py-line"><span class="py-docstring">    used to test pyrex interface to g2_unpack1"""</span> </span>
<span class="py-lineno">1114</span>  <span class="py-line">    <span class="py-name">idsect</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno">1115</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">5</span> </span>
<span class="py-lineno">1116</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;h'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1117</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">2</span> </span>
<span class="py-lineno">1118</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;h'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1119</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">2</span> </span>
<span class="py-lineno">1120</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1121</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1122</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1123</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1124</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1125</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1126</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;h'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">:</span><span class="py-name">pos</span><span class="py-op">+</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1127</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">2</span> </span>
<span class="py-lineno">1128</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1129</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1130</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1131</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1132</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1133</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1134</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1135</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1136</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1137</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1138</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1139</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1140</span>  <span class="py-line">    <span class="py-name">idsect</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">struct</span><span class="py-op">.</span><span class="py-name">unpack</span><span class="py-op">(</span><span class="py-string">'&gt;B'</span><span class="py-op">,</span><span class="py-name">gribmsg</span><span class="py-op">[</span><span class="py-name">pos</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">[</span><span class="py-number">0</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1141</span>  <span class="py-line">    <span class="py-name">pos</span> <span class="py-op">=</span> <span class="py-name">pos</span> <span class="py-op">+</span> <span class="py-number">1</span> </span>
<span class="py-lineno">1142</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">idsect</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">pos</span> </span>
</div><span class="py-lineno">1143</span>  <span class="py-line"> </span>
<a name="_repeatlast"></a><div id="_repeatlast-def"><span class="py-lineno">1144</span> <a class="py-toggle" href="#" id="_repeatlast-toggle" onclick="toggle('_repeatlast'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_repeatlast">_repeatlast</a><span class="py-op">(</span><span class="py-param">numfields</span><span class="py-op">,</span><span class="py-param">listin</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_repeatlast-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_repeatlast-expanded"><span class="py-lineno">1145</span>  <span class="py-line">    <span class="py-docstring">"""repeat last item in listin, until len(listin) = numfields"""</span> </span>
<span class="py-lineno">1146</span>  <span class="py-line">    <span class="py-keyword">if</span> <span class="py-name">len</span><span class="py-op">(</span><span class="py-name">listin</span><span class="py-op">)</span> <span class="py-op">&lt;</span> <span class="py-name">numfields</span><span class="py-op">:</span> </span>
<span class="py-lineno">1147</span>  <span class="py-line">        <span class="py-name">last</span> <span class="py-op">=</span> <span class="py-name">listin</span><span class="py-op">[</span><span class="py-op">-</span><span class="py-number">1</span><span class="py-op">]</span> </span>
<span class="py-lineno">1148</span>  <span class="py-line">        <span class="py-keyword">for</span> <span class="py-name">n</span> <span class="py-keyword">in</span> <span class="py-name">range</span><span class="py-op">(</span><span class="py-name">len</span><span class="py-op">(</span><span class="py-name">listin</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">numfields</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno">1149</span>  <span class="py-line">            <span class="py-name">listin</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">last</span><span class="py-op">)</span> </span>
<span class="py-lineno">1150</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">listin</span> </span>
</div><span class="py-lineno">1151</span>  <span class="py-line"> </span>
<a name="_flatten"></a><div id="_flatten-def"><span class="py-lineno">1152</span> <a class="py-toggle" href="#" id="_flatten-toggle" onclick="toggle('_flatten'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_flatten">_flatten</a><span class="py-op">(</span><span class="py-param">numfields</span><span class="py-op">,</span> <span class="py-param">listin</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_flatten-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_flatten-expanded"><span class="py-lineno">1153</span>  <span class="py-line">   <span class="py-name">listout</span> <span class="py-op">=</span> <span class="py-op">[</span><span class="py-op">]</span> </span>
<span class="py-lineno">1154</span>  <span class="py-line">   <span class="py-keyword">for</span> <span class="py-name">n</span> <span class="py-keyword">in</span> <span class="py-name">xrange</span><span class="py-op">(</span><span class="py-name">len</span><span class="py-op">(</span><span class="py-name">listin</span><span class="py-op">)</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno">1155</span>  <span class="py-line">       <span class="py-keyword">for</span> <span class="py-name">i</span> <span class="py-keyword">in</span> <span class="py-name">xrange</span><span class="py-op">(</span><span class="py-name">numfields</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">)</span><span class="py-op">:</span> </span>
<span class="py-lineno">1156</span>  <span class="py-line">           <span class="py-name">listout</span><span class="py-op">.</span><span class="py-name">append</span><span class="py-op">(</span><span class="py-name">listin</span><span class="py-op">[</span><span class="py-name">n</span><span class="py-op">]</span><span class="py-op">[</span><span class="py-name">i</span><span class="py-op">]</span><span class="py-op">)</span> </span>
<span class="py-lineno">1157</span>  <span class="py-line">   <span class="py-keyword">return</span> <span class="py-name">listout</span> </span>
</div><span class="py-lineno">1158</span>  <span class="py-line"> </span>
<a name="_isString"></a><div id="_isString-def"><span class="py-lineno">1159</span> <a class="py-toggle" href="#" id="_isString-toggle" onclick="toggle('_isString'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_isString">_isString</a><span class="py-op">(</span><span class="py-param">string</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_isString-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_isString-expanded"><span class="py-lineno">1160</span>  <span class="py-line">    <span class="py-docstring">"""Test if string is a string like object if not return 0 """</span> </span>
<span class="py-lineno">1161</span>  <span class="py-line">    <span class="py-keyword">try</span><span class="py-op">:</span> <span class="py-name">string</span> <span class="py-op">+</span> <span class="py-string">''</span> </span>
<span class="py-lineno">1162</span>  <span class="py-line">    <span class="py-keyword">except</span><span class="py-op">:</span> <span class="py-keyword">return</span> <span class="py-number">0</span> </span>
<span class="py-lineno">1163</span>  <span class="py-line">    <span class="py-keyword">else</span><span class="py-op">:</span> <span class="py-keyword">return</span> <span class="py-number">1</span> </span>
</div><span class="py-lineno">1164</span>  <span class="py-line"> </span>
<a name="_meshgrid"></a><div id="_meshgrid-def"><span class="py-lineno">1165</span> <a class="py-toggle" href="#" id="_meshgrid-toggle" onclick="toggle('_meshgrid'); return false;">-</a><span class="py-line"><span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2-module.html#_meshgrid">_meshgrid</a><span class="py-op">(</span><span class="py-param">x</span><span class="py-op">,</span> <span class="py-param">y</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="_meshgrid-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="_meshgrid-expanded"><span class="py-lineno">1166</span>  <span class="py-line">    <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1167</span>  <span class="py-line"><span class="py-docstring">    For vectors x, y with lengths Nx=len(x) and Ny=len(y), return X, Y</span> </span>
<span class="py-lineno">1168</span>  <span class="py-line"><span class="py-docstring">    where X and Y are (Ny, Nx) shaped arrays with the elements of x</span> </span>
<span class="py-lineno">1169</span>  <span class="py-line"><span class="py-docstring">    and y repeated to fill the matrix</span> </span>
<span class="py-lineno">1170</span>  <span class="py-line"><span class="py-docstring">    """</span> </span>
<span class="py-lineno">1171</span>  <span class="py-line">    <span class="py-name">x</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">x</span><span class="py-op">)</span> </span>
<span class="py-lineno">1172</span>  <span class="py-line">    <span class="py-name">y</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">y</span><span class="py-op">)</span> </span>
<span class="py-lineno">1173</span>  <span class="py-line">    <span class="py-name">numRows</span><span class="py-op">,</span> <span class="py-name">numCols</span> <span class="py-op">=</span> <span class="py-name">len</span><span class="py-op">(</span><span class="py-name">y</span><span class="py-op">)</span><span class="py-op">,</span> <span class="py-name">len</span><span class="py-op">(</span><span class="py-name">x</span><span class="py-op">)</span>  <span class="py-comment"># yes, reversed</span> </span>
<span class="py-lineno">1174</span>  <span class="py-line">    <span class="py-name">x</span><span class="py-op">.</span><span class="py-name">shape</span> <span class="py-op">=</span> <span class="py-number">1</span><span class="py-op">,</span> <span class="py-name">numCols</span> </span>
<span class="py-lineno">1175</span>  <span class="py-line">    <span class="py-name">X</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">repeat</span><span class="py-op">(</span><span class="py-name">x</span><span class="py-op">,</span> <span class="py-name">numRows</span><span class="py-op">,</span> <span class="py-number">0</span><span class="py-op">)</span> </span>
<span class="py-lineno">1176</span>  <span class="py-line">    <span class="py-name">y</span><span class="py-op">.</span><span class="py-name">shape</span> <span class="py-op">=</span> <span class="py-name">numRows</span><span class="py-op">,</span><span class="py-number">1</span> </span>
<span class="py-lineno">1177</span>  <span class="py-line">    <span class="py-name">Y</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">repeat</span><span class="py-op">(</span><span class="py-name">y</span><span class="py-op">,</span> <span class="py-name">numCols</span><span class="py-op">,</span> <span class="py-number">1</span><span class="py-op">)</span> </span>
<span class="py-lineno">1178</span>  <span class="py-line">    <span class="py-keyword">return</span> <span class="py-name">X</span><span class="py-op">,</span> <span class="py-name">Y</span> </span>
</div><span class="py-lineno">1179</span>  <span class="py-line"> </span>
<a name="Grib2Encode"></a><div id="Grib2Encode-def"><span class="py-lineno">1180</span> <a class="py-toggle" href="#" id="Grib2Encode-toggle" onclick="toggle('Grib2Encode'); return false;">-</a><span class="py-line"><span class="py-keyword">class</span> <a class="py-def-name" href="grib2.grib2.Grib2Encode-class.html">Grib2Encode</a><span class="py-op">:</span> </span>
</div><div id="Grib2Encode-collapsed" style="display:none;" pad="++++" indent="++++"></div><div id="Grib2Encode-expanded"><span class="py-lineno">1181</span>  <span class="py-line">    <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1182</span>  <span class="py-line"><span class="py-docstring"> Class for encoding data into a GRIB2 message.</span> </span>
<span class="py-lineno">1183</span>  <span class="py-line"><span class="py-docstring">  - Creating a class instance (L{__init__}) initializes the message and adds </span> </span>
<span class="py-lineno">1184</span>  <span class="py-line"><span class="py-docstring">    sections 0 and 1 (the indicator and identification sections), </span> </span>
<span class="py-lineno">1185</span>  <span class="py-line"><span class="py-docstring">  - method L{addgrid} adds a grid definition (section 3) to the messsage.</span> </span>
<span class="py-lineno">1186</span>  <span class="py-line"><span class="py-docstring">  - method L{addfield} adds sections 4-7 to the message (the product</span> </span>
<span class="py-lineno">1187</span>  <span class="py-line"><span class="py-docstring">    definition, data representation, bitmap and data sections).</span> </span>
<span class="py-lineno">1188</span>  <span class="py-line"><span class="py-docstring">  - method L{end} adds the end section (section 8) and terminates the message.</span> </span>
<span class="py-lineno">1189</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1190</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1191</span>  <span class="py-line"><span class="py-docstring"> A GRIB Edition 2 message is a machine independent format for storing</span> </span>
<span class="py-lineno">1192</span>  <span class="py-line"><span class="py-docstring"> one or more gridded data fields.  Each GRIB2 message consists of the </span> </span>
<span class="py-lineno">1193</span>  <span class="py-line"><span class="py-docstring"> following sections:</span> </span>
<span class="py-lineno">1194</span>  <span class="py-line"><span class="py-docstring">  - SECTION 0: Indicator Section - only one per message</span> </span>
<span class="py-lineno">1195</span>  <span class="py-line"><span class="py-docstring">  - SECTION 1: Identification Section - only one per message</span> </span>
<span class="py-lineno">1196</span>  <span class="py-line"><span class="py-docstring">  - SECTION 2: (Local Use Section) - optional                          </span> </span>
<span class="py-lineno">1197</span>  <span class="py-line"><span class="py-docstring">  - SECTION 3: Grid Definition Section                                </span> </span>
<span class="py-lineno">1198</span>  <span class="py-line"><span class="py-docstring">  - SECTION 4: Product Definition Section              </span> </span>
<span class="py-lineno">1199</span>  <span class="py-line"><span class="py-docstring">  - SECTION 5: Data Representation Section   </span> </span>
<span class="py-lineno">1200</span>  <span class="py-line"><span class="py-docstring">  - SECTION 6: Bit-map Section               </span> </span>
<span class="py-lineno">1201</span>  <span class="py-line"><span class="py-docstring">  - SECTION 7: Data Section                  </span> </span>
<span class="py-lineno">1202</span>  <span class="py-line"><span class="py-docstring">  - SECTION 8: End Section                   </span> </span>
<span class="py-lineno">1203</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1204</span>  <span class="py-line"><span class="py-docstring"> Sequences of GRIB sections 2 to 7, 3 to 7, or sections 4 to 7 may be repeated</span> </span>
<span class="py-lineno">1205</span>  <span class="py-line"><span class="py-docstring"> within a single GRIB message.  All sections within such repeated sequences</span> </span>
<span class="py-lineno">1206</span>  <span class="py-line"><span class="py-docstring"> must be present and shall appear in the numerical order noted above.</span> </span>
<span class="py-lineno">1207</span>  <span class="py-line"><span class="py-docstring"> Unrepeated sections remain in effect until redefined.</span> </span>
<span class="py-lineno">1208</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1209</span>  <span class="py-line"><span class="py-docstring"> Note:  Reading/writing section 2 (the 'local use section') is</span> </span>
<span class="py-lineno">1210</span>  <span class="py-line"><span class="py-docstring"> not yet supported.</span> </span>
<span class="py-lineno">1211</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1212</span>  <span class="py-line"><span class="py-docstring"> @ivar msg: A binary string containing the GRIB2 message.</span> </span>
<span class="py-lineno">1213</span>  <span class="py-line"><span class="py-docstring"> After the message has been terminated by calling</span> </span>
<span class="py-lineno">1214</span>  <span class="py-line"><span class="py-docstring"> the L{end} method, this string can be written to a file.</span> </span>
<span class="py-lineno">1215</span>  <span class="py-line"><span class="py-docstring">    """</span> </span>
<span class="py-lineno">1216</span>  <span class="py-line"> </span>
<a name="Grib2Encode.__init__"></a><div id="Grib2Encode.__init__-def"><span class="py-lineno">1217</span> <a class="py-toggle" href="#" id="Grib2Encode.__init__-toggle" onclick="toggle('Grib2Encode.__init__'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Encode-class.html#__init__">__init__</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span> <span class="py-param">discipline</span><span class="py-op">,</span> <span class="py-param">idsect</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Encode.__init__-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Encode.__init__-expanded"><span class="py-lineno">1218</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1219</span>  <span class="py-line"><span class="py-docstring"> create a Grib2Enecode class instance given the GRIB2 discipline</span> </span>
<span class="py-lineno">1220</span>  <span class="py-line"><span class="py-docstring"> parameter and the identification section (sections 0 and 1).</span> </span>
<span class="py-lineno">1221</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1222</span>  <span class="py-line"><span class="py-docstring"> The GRIB2 message is stored as a binary string in instance variable L{msg}.</span> </span>
<span class="py-lineno">1223</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1224</span>  <span class="py-line"><span class="py-docstring"> L{addgrid}, L{addfield} and L{end} class methods must be called to complete</span> </span>
<span class="py-lineno">1225</span>  <span class="py-line"><span class="py-docstring"> the GRIB2 message.</span> </span>
<span class="py-lineno">1226</span>  <span class="py-line"><span class="py-docstring"> </span> </span>
<span class="py-lineno">1227</span>  <span class="py-line"><span class="py-docstring"> @param discipline:  Discipline or GRIB Master Table Number (Code Table 0.0).</span> </span>
<span class="py-lineno">1228</span>  <span class="py-line"><span class="py-docstring"> (0 for meteorlogical, 1 for hydrological, 2 for land surface, 3 for space,</span> </span>
<span class="py-lineno">1229</span>  <span class="py-line"><span class="py-docstring"> 10 for oceanographic products).</span> </span>
<span class="py-lineno">1230</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1231</span>  <span class="py-line"><span class="py-docstring"> @param idsect:  Sequence containing identification section (section 1).</span> </span>
<span class="py-lineno">1232</span>  <span class="py-line"><span class="py-docstring">  - idsect[0]=Id of orginating centre (Common Code Table C-1) </span> </span>
<span class="py-lineno">1233</span>  <span class="py-line"><span class="py-docstring">  - idsect[1]=Id of orginating sub-centre (local table) </span> </span>
<span class="py-lineno">1234</span>  <span class="py-line"><span class="py-docstring">  - idsect[2]=GRIB Master Tables Version Number (Code Table 1.0) </span> </span>
<span class="py-lineno">1235</span>  <span class="py-line"><span class="py-docstring">  - idsect[3]=GRIB Local Tables Version Number (Code Table 1.1) </span> </span>
<span class="py-lineno">1236</span>  <span class="py-line"><span class="py-docstring">  - idsect[4]=Significance of Reference Time (Code Table 1.2) </span> </span>
<span class="py-lineno">1237</span>  <span class="py-line"><span class="py-docstring">  - idsect[5]=Reference Time - Year (4 digits) </span> </span>
<span class="py-lineno">1238</span>  <span class="py-line"><span class="py-docstring">  - idsect[6]=Reference Time - Month </span> </span>
<span class="py-lineno">1239</span>  <span class="py-line"><span class="py-docstring">  - idsect[7]=Reference Time - Day </span> </span>
<span class="py-lineno">1240</span>  <span class="py-line"><span class="py-docstring">  - idsect[8]=Reference Time - Hour </span> </span>
<span class="py-lineno">1241</span>  <span class="py-line"><span class="py-docstring">  - idsect[9]=Reference Time - Minute </span> </span>
<span class="py-lineno">1242</span>  <span class="py-line"><span class="py-docstring">  - idsect[10]=Reference Time - Second </span> </span>
<span class="py-lineno">1243</span>  <span class="py-line"><span class="py-docstring">  - idsect[11]=Production status of data (Code Table 1.3) </span> </span>
<span class="py-lineno">1244</span>  <span class="py-line"><span class="py-docstring">  - idsect[12]=Type of processed data (Code Table 1.4) </span> </span>
<span class="py-lineno">1245</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">1246</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">msglen</span><span class="py-op">=</span><span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">grib2_create</span><span class="py-op">(</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-op">[</span><span class="py-name">discipline</span><span class="py-op">,</span><span class="py-number">2</span><span class="py-op">]</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">idsect</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">)</span> </span>
</div><span class="py-lineno">1247</span>  <span class="py-line"> </span>
<a name="Grib2Encode.addgrid"></a><div id="Grib2Encode.addgrid-def"><span class="py-lineno">1248</span> <a class="py-toggle" href="#" id="Grib2Encode.addgrid-toggle" onclick="toggle('Grib2Encode.addgrid'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Encode-class.html#addgrid">addgrid</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span><span class="py-param">gdsinfo</span><span class="py-op">,</span><span class="py-param">gdtmpl</span><span class="py-op">,</span><span class="py-param">deflist</span><span class="py-op">=</span><span class="py-name">None</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Encode.addgrid-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Encode.addgrid-expanded"><span class="py-lineno">1249</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1250</span>  <span class="py-line"><span class="py-docstring"> Add a grid definition section (section 3) to the GRIB2 message.</span> </span>
<span class="py-lineno">1251</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1252</span>  <span class="py-line"><span class="py-docstring"> @param gdsinfo: Sequence containing information needed for the grid definition section.</span> </span>
<span class="py-lineno">1253</span>  <span class="py-line"><span class="py-docstring">  - gdsinfo[0] = Source of grid definition (see Code Table 3.0) </span> </span>
<span class="py-lineno">1254</span>  <span class="py-line"><span class="py-docstring">  - gdsinfo[1] = Number of grid points in the defined grid.</span> </span>
<span class="py-lineno">1255</span>  <span class="py-line"><span class="py-docstring">  - gdsinfo[2] = Number of octets needed for each additional grid points defn.</span> </span>
<span class="py-lineno">1256</span>  <span class="py-line"><span class="py-docstring">    Used to define number of points in each row for non-reg grids (=0 for </span> </span>
<span class="py-lineno">1257</span>  <span class="py-line"><span class="py-docstring">    regular grid).</span> </span>
<span class="py-lineno">1258</span>  <span class="py-line"><span class="py-docstring">  - gdsinfo[3] = Interp. of list for optional points defn (Code Table 3.11)</span> </span>
<span class="py-lineno">1259</span>  <span class="py-line"><span class="py-docstring">  - gdsinfo[4] = Grid Definition Template Number (Code Table 3.1)</span> </span>
<span class="py-lineno">1260</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1261</span>  <span class="py-line"><span class="py-docstring"> @param gdtmpl: Contains the data values for the specified Grid Definition </span> </span>
<span class="py-lineno">1262</span>  <span class="py-line"><span class="py-docstring"> Template ( NN=gds[4] ).  Each element of this integer  </span> </span>
<span class="py-lineno">1263</span>  <span class="py-line"><span class="py-docstring"> array contains an entry (in the order specified) of Grid </span> </span>
<span class="py-lineno">1264</span>  <span class="py-line"><span class="py-docstring"> Definition Template 3.NN </span> </span>
<span class="py-lineno">1265</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1266</span>  <span class="py-line"><span class="py-docstring"> @param deflist: (Used if gds[2] != 0)  Sequence containing the</span> </span>
<span class="py-lineno">1267</span>  <span class="py-line"><span class="py-docstring"> number of grid points contained in each row (or column) </span> </span>
<span class="py-lineno">1268</span>  <span class="py-line"><span class="py-docstring"> of a non-regular grid.</span> </span>
<span class="py-lineno">1269</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">1270</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">deflist</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno">1271</span>  <span class="py-line">            <span class="py-name">dflist</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">deflist</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span> </span>
<span class="py-lineno">1272</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1273</span>  <span class="py-line">            <span class="py-name">dflist</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1274</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">msglen</span><span class="py-op">=</span><span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">grib2_addgrid</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">gdsinfo</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">gdtmpl</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">dflist</span><span class="py-op">)</span> </span>
</div><span class="py-lineno">1275</span>  <span class="py-line"> </span>
<a name="Grib2Encode.addfield"></a><div id="Grib2Encode.addfield-def"><span class="py-lineno">1276</span> <a class="py-toggle" href="#" id="Grib2Encode.addfield-toggle" onclick="toggle('Grib2Encode.addfield'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Encode-class.html#addfield">addfield</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">,</span><span class="py-param">pdtnum</span><span class="py-op">,</span><span class="py-param">pdtmpl</span><span class="py-op">,</span><span class="py-param">drtnum</span><span class="py-op">,</span><span class="py-param">drtmpl</span><span class="py-op">,</span><span class="py-param">field</span><span class="py-op">,</span><span class="py-param">coordlist</span><span class="py-op">=</span><span class="py-name">None</span><span class="py-op">,</span><span class="py-param">bitmapflag</span><span class="py-op">=</span><span class="py-number">255</span><span class="py-op">,</span><span class="py-param">bitmap</span><span class="py-op">=</span><span class="py-name">None</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Encode.addfield-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Encode.addfield-expanded"><span class="py-lineno">1277</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1278</span>  <span class="py-line"><span class="py-docstring"> Add a product definition section, data representation section,</span> </span>
<span class="py-lineno">1279</span>  <span class="py-line"><span class="py-docstring"> bitmap section and data section to the GRIB2 message (sections 4-7).</span> </span>
<span class="py-lineno">1280</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1281</span>  <span class="py-line"><span class="py-docstring"> @param pdtnum: Product Definition Template Number (see Code Table 4.0)</span> </span>
<span class="py-lineno">1282</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1283</span>  <span class="py-line"><span class="py-docstring"> @param pdtmpl: Sequence with the data values for the specified Product Definition</span> </span>
<span class="py-lineno">1284</span>  <span class="py-line"><span class="py-docstring"> Template (N=pdtnum).  Each element of this integer </span> </span>
<span class="py-lineno">1285</span>  <span class="py-line"><span class="py-docstring"> array contains an entry (in the order specified) of Product</span> </span>
<span class="py-lineno">1286</span>  <span class="py-line"><span class="py-docstring"> Definition Template 4.N</span> </span>
<span class="py-lineno">1287</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1288</span>  <span class="py-line"><span class="py-docstring"> @param drtnum: Data Representation Template Number (see Code Table 5.0).</span> </span>
<span class="py-lineno">1289</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1290</span>  <span class="py-line"><span class="py-docstring"> @param drtmpl: Sequence with the data values for the specified Data Representation</span> </span>
<span class="py-lineno">1291</span>  <span class="py-line"><span class="py-docstring"> Template (N=drtnum).  Each element of this integer </span> </span>
<span class="py-lineno">1292</span>  <span class="py-line"><span class="py-docstring"> array contains an entry (in the order specified) of Data</span> </span>
<span class="py-lineno">1293</span>  <span class="py-line"><span class="py-docstring"> Representation Template 5.N</span> </span>
<span class="py-lineno">1294</span>  <span class="py-line"><span class="py-docstring"> Note that some values in this template (eg. reference</span> </span>
<span class="py-lineno">1295</span>  <span class="py-line"><span class="py-docstring"> values, number of bits, etc...) may be changed by the</span> </span>
<span class="py-lineno">1296</span>  <span class="py-line"><span class="py-docstring"> data packing algorithms.</span> </span>
<span class="py-lineno">1297</span>  <span class="py-line"><span class="py-docstring"> Use this to specify scaling factors and order of</span> </span>
<span class="py-lineno">1298</span>  <span class="py-line"><span class="py-docstring"> spatial differencing, if desired.</span> </span>
<span class="py-lineno">1299</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1300</span>  <span class="py-line"><span class="py-docstring"> @param field:  float32 numpy array of data points to pack.</span> </span>
<span class="py-lineno">1301</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1302</span>  <span class="py-line"><span class="py-docstring"> @param coordlist: Sequence containing floating point values intended to document</span> </span>
<span class="py-lineno">1303</span>  <span class="py-line"><span class="py-docstring"> the vertical discretization with model data</span> </span>
<span class="py-lineno">1304</span>  <span class="py-line"><span class="py-docstring"> on hybrid coordinate vertical levels. Default None.</span> </span>
<span class="py-lineno">1305</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1306</span>  <span class="py-line"><span class="py-docstring"> @param bitmapflag: Bitmap indicator (see Code Table 6.0) Default 255.</span> </span>
<span class="py-lineno">1307</span>  <span class="py-line"><span class="py-docstring">  - 0 = bitmap applies and is included in Section 6.</span> </span>
<span class="py-lineno">1308</span>  <span class="py-line"><span class="py-docstring">  - 1-253 = Predefined bitmap applies</span> </span>
<span class="py-lineno">1309</span>  <span class="py-line"><span class="py-docstring">  - 254 = Previously defined bitmap applies to this field</span> </span>
<span class="py-lineno">1310</span>  <span class="py-line"><span class="py-docstring">    (it still must be provided, it just won't</span> </span>
<span class="py-lineno">1311</span>  <span class="py-line"><span class="py-docstring">    be encoded into the message again)</span> </span>
<span class="py-lineno">1312</span>  <span class="py-line"><span class="py-docstring">  - 255 = Bit map does not apply to this product.</span> </span>
<span class="py-lineno">1313</span>  <span class="py-line"><span class="py-docstring"></span> </span>
<span class="py-lineno">1314</span>  <span class="py-line"><span class="py-docstring"> @param bitmap: int32 numpy array containing bitmap to be added </span> </span>
<span class="py-lineno">1315</span>  <span class="py-line"><span class="py-docstring"> (if bitmapflag=0 or 254). Default None.</span> </span>
<span class="py-lineno">1316</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">1317</span>  <span class="py-line">        <span class="py-name">fld</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">field</span><span class="py-op">.</span><span class="py-name">astype</span><span class="py-op">(</span><span class="py-string">'f'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
<span class="py-lineno">1318</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">bitmap</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno">1319</span>  <span class="py-line">            <span class="py-name">bmap</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">ravel</span><span class="py-op">(</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">bitmap</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">)</span> </span>
<span class="py-lineno">1320</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1321</span>  <span class="py-line">            <span class="py-name">bmap</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1322</span>  <span class="py-line">        <span class="py-keyword">if</span> <span class="py-name">coordlist</span> <span class="py-keyword">is</span> <span class="py-keyword">not</span> <span class="py-name">None</span><span class="py-op">:</span> </span>
<span class="py-lineno">1323</span>  <span class="py-line">            <span class="py-name">crdlist</span> <span class="py-op">=</span> <span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">coordlist</span><span class="py-op">,</span><span class="py-string">'f'</span><span class="py-op">)</span> </span>
<span class="py-lineno">1324</span>  <span class="py-line">        <span class="py-keyword">else</span><span class="py-op">:</span> </span>
<span class="py-lineno">1325</span>  <span class="py-line">            <span class="py-name">crdlist</span> <span class="py-op">=</span> <span class="py-name">None</span> </span>
<span class="py-lineno">1326</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">msglen</span><span class="py-op">=</span><span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">grib2_addfield</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">pdtnum</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">pdtmpl</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">crdlist</span><span class="py-op">,</span><span class="py-name">drtnum</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">array</span><span class="py-op">(</span><span class="py-name">drtmpl</span><span class="py-op">,</span><span class="py-string">'i'</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">N</span><span class="py-op">.</span><span class="py-name">ravel</span><span class="py-op">(</span><span class="py-name">fld</span><span class="py-op">)</span><span class="py-op">,</span><span class="py-name">bitmapflag</span><span class="py-op">,</span><span class="py-name">bmap</span><span class="py-op">)</span> </span>
</div><span class="py-lineno">1327</span>  <span class="py-line"> </span>
<a name="Grib2Encode.end"></a><div id="Grib2Encode.end-def"><span class="py-lineno">1328</span> <a class="py-toggle" href="#" id="Grib2Encode.end-toggle" onclick="toggle('Grib2Encode.end'); return false;">-</a><span class="py-line">    <span class="py-keyword">def</span> <a class="py-def-name" href="grib2.grib2.Grib2Encode-class.html#end">end</a><span class="py-op">(</span><span class="py-param">self</span><span class="py-op">)</span><span class="py-op">:</span> </span>
</div><div id="Grib2Encode.end-collapsed" style="display:none;" pad="++++" indent="++++++++"></div><div id="Grib2Encode.end-expanded"><span class="py-lineno">1329</span>  <span class="py-line">        <span class="py-docstring">"""</span> </span>
<span class="py-lineno">1330</span>  <span class="py-line"><span class="py-docstring"> Add an end section (section 8) to the GRIB2 message.</span> </span>
<span class="py-lineno">1331</span>  <span class="py-line"><span class="py-docstring"> A GRIB2 message is not complete without an end section.</span> </span>
<span class="py-lineno">1332</span>  <span class="py-line"><span class="py-docstring"> Once an end section is added, the GRIB2 message can be</span> </span>
<span class="py-lineno">1333</span>  <span class="py-line"><span class="py-docstring"> output to a file.</span> </span>
<span class="py-lineno">1334</span>  <span class="py-line"><span class="py-docstring">        """</span> </span>
<span class="py-lineno">1335</span>  <span class="py-line">        <span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">,</span><span class="py-name">msglen</span><span class="py-op">=</span><span class="py-name">g2lib</span><span class="py-op">.</span><span class="py-name">grib2_end</span><span class="py-op">(</span><span class="py-name">self</span><span class="py-op">.</span><span class="py-name">msg</span><span class="py-op">)</span> </span>
</div></div><span class="py-lineno">1336</span>  <span class="py-line"> </span><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th bgcolor="#70b0f0" class="navbar-select"
          >&nbsp;&nbsp;&nbsp;Home&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">Generated by Epydoc
        3.0alpha3 on Mon May 14 16:46:17 2007</td>
    <td align="right" class="footer">
      <a href="http://epydoc.sourceforge.net">http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie()
  // -->
</script>
  
</body>
</html>
